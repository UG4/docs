<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ug4: ugbase/lib_algebra/operator/eigensolver/pinvit.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ug4
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('pinvit_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">pinvit.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="pinvit_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2010-2015:  G-CSC, Goethe University Frankfurt</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Author: Martin Rupp</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * This file is part of UG4.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * UG4 is free software: you can redistribute it and/or modify it under the</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * terms of the GNU Lesser General Public License version 3 (as published by the</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * Free Software Foundation) with the following additional attribution</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * requirements (according to LGPL/GPL v3 §7):</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * (1) The following notice must be displayed in the Appropriate Legal Notices</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * of covered and combined works: &quot;Based on UG4 (www.ug4.org/license)&quot;.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * (2) The following notice must be displayed at a prominent place in the</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * terminal output of covered works: &quot;Based on UG4 (www.ug4.org/license)&quot;.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * (3) The following bibliography is recommended for citation and must be</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * preserved in all covered files:</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * &quot;Reiter, S., Vogel, A., Heppner, I., Rupp, M., and Wittum, G. A massively</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> *   parallel geometric multigrid solver on hierarchically distributed grids.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *   Computing and visualization in science 16, 4 (2013), 151-164&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * &quot;Vogel, A., Reiter, S., Rupp, M., Nägel, A., and Wittum, G. UG4 -- a novel</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> *   flexible software system for simulating pde based models on high performance</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> *   computers. Computing and visualization in science 16, 4 (2013), 165-179&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * GNU Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#ifndef __H__UG__LIB_ALGEBRA__PINVIT_H__</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#define __H__UG__LIB_ALGEBRA__PINVIT_H__</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;complex&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="string__util_8h.html">common/util/string_util.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sort__util_8h.html">common/util/sort_util.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="small__algebra_2additional__math_8h.html">additional_math.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="eigenvalue2_8h.html">lib_algebra/small_algebra/lapack/eigenvalue2.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="linear__operator_8h.html">lib_algebra/operator/interface/linear_operator.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="preconditioner_8h.html">lib_algebra/operator/interface/preconditioner.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="matrix__operator_8h.html">lib_algebra/operator/interface/matrix_operator.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="debug__writer_8h.html">lib_algebra/operator/debug_writer.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="progress_8h.html">common/progress.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="lib__algebra_2algebra__common_2vector__util_8h.html">lib_algebra/algebra_common/vector_util.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="smart__ptr__vector_8h.html">smart_ptr_vector.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">// constructors</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceug.html">ug</a>{</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> TAlgebra&gt;</div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html">  102</a></span>&#160;<span class="keyword">class </span><a class="code" href="classug_1_1_p_i_n_v_i_t.html">PINVIT</a></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    : <span class="keyword">public</span> <a class="code" href="classug_1_1_debug_writing_object.html">DebugWritingObject</a>&lt;TAlgebra&gt;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">//  Algebra type</span></div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#adf61a0760e11a5f4f1d18aa55d232e21">  107</a></span>&#160;  <span class="keyword">typedef</span> TAlgebra <a class="code" href="classug_1_1_p_i_n_v_i_t.html#adf61a0760e11a5f4f1d18aa55d232e21">algebra_type</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">//  Vector type</span></div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a45ca905726a015d40b687cc8bd18fd9a">  110</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> TAlgebra::vector_type <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a45ca905726a015d40b687cc8bd18fd9a">vector_type</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a8c82e4d68d68248e586a11d8ba8b863c">  111</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> TAlgebra::matrix_type <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a8c82e4d68d68248e586a11d8ba8b863c">matrix_type</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ab2da2a31c40c7cb6ee1f2aea85f3a92b">  112</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="sparsematrix__interface_8h.html#a265a253612b46abed17c61b0a5e5ce30">vector_type::value_type</a> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ab2da2a31c40c7cb6ee1f2aea85f3a92b">vector_value_type</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a6913f1dde8179921c4d0b7bac6d7e4a7">  115</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classug_1_1_debug_writing_object.html">DebugWritingObject&lt;TAlgebra&gt;</a> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a6913f1dde8179921c4d0b7bac6d7e4a7">base_type</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keyword">using</span> <a class="code" href="classug_1_1_debug_writing_object.html#a182b95496411d505fcb29b5381419131">base_type::set_debug</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keyword">using</span> <a class="code" href="classug_1_1_debug_writing_object.html#a947b41828b12248936a9bc1e9b7463ae">base_type::debug_writer</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keyword">using</span> <a class="code" href="classug_1_1_debug_writing_object.html#a306270884f90183986354310a5be4ab5">base_type::write_debug</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="comment">//ILinearOperator&lt;vector_type,vector_type&gt;* m_pA;</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">//ILinearOperator&lt;vector_type,vector_type&gt;* m_pB;</span></div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a3d00f979c3c39acf3b5a8b414fbd24df">  125</a></span>&#160;  <a class="code" href="class_smart_ptr.html">SmartPtr&lt;ILinearOperator&lt;vector_type&gt;</a> &gt; <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a3d00f979c3c39acf3b5a8b414fbd24df">m_pA</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a7af526c8b8827f08e182acd87ec203c0">  127</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classug_1_1_matrix_operator.html">IPreconditioner&lt;TAlgebra&gt;::matrix_operator_type</a> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a7af526c8b8827f08e182acd87ec203c0">matrix_operator_type</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a41e0d6a7931895c7ea09b5bc7e5e3ecd">  128</a></span>&#160;  <a class="code" href="classug_1_1_matrix_operator.html">matrix_operator_type</a> *<a class="code" href="classug_1_1_p_i_n_v_i_t.html#a41e0d6a7931895c7ea09b5bc7e5e3ecd">m_pB</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#af24635ed0789813f7eb2df2377600144">  130</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#af24635ed0789813f7eb2df2377600144">m_dMinimumDefectToCalcCorrection</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ad947a96e0f668b16dc2b6dd7c7637e96">  132</a></span>&#160;  <a class="code" href="classug_1_1_smart_ptr_vector.html">SmartPtrVector&lt;vector_type&gt;</a> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ad947a96e0f668b16dc2b6dd7c7637e96">px</a>;</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a1a307a01ba61faa783f789b54ca18528">  133</a></span>&#160;  <a class="code" href="class_smart_ptr.html">SmartPtr&lt;ILinearIterator&lt;vector_type&gt;</a> &gt; <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a1a307a01ba61faa783f789b54ca18528">m_spPrecond</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#aa77dadc26f6be3f2beee8078c18415e3">  135</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#aa77dadc26f6be3f2beee8078c18415e3">m_maxIterations</a>;</div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a6b3bdd607dfe9e438a3f607883ebe8fb">  136</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a6b3bdd607dfe9e438a3f607883ebe8fb">m_dPrecision</a>;</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a0c28c878f414b6563282f0eb819a658a">  137</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a0c28c878f414b6563282f0eb819a658a">m_bRelativePrecision</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a6d51438c950df0b23f8dfeb3e8d8c61e">  138</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a6d51438c950df0b23f8dfeb3e8d8c61e">m_iPINVIT</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a7f43af63812849e8a78015b43d0ddb53">  139</a></span>&#160;  std::vector&lt;double&gt; <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a7f43af63812849e8a78015b43d0ddb53">lambda</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a60650ba5bc7f1de117035aa3de4b4605">  140</a></span>&#160;  std::vector&lt;bool&gt; <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a60650ba5bc7f1de117035aa3de4b4605">vbDirichlet</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a66c9acb0d5e2895f37db77b40d209da5">  142</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a66c9acb0d5e2895f37db77b40d209da5">m_linearDependentEps</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a8adfcf43fe55d8b7a5a404d05c6aae04">  144</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a8adfcf43fe55d8b7a5a404d05c6aae04">m_bLaplacian</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a3ab558db7969edbdfac83ee86d091c89">  146</a></span>&#160;  std::vector&lt;double&gt; <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a3ab558db7969edbdfac83ee86d091c89">freq_change</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a66ad05e8732bab43e3eb90f8fa8124ed">  147</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a66ad05e8732bab43e3eb90f8fa8124ed">m_dDensity_linear_elasticity</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a1282b15978290327b8f630dd9aa28886">  148</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a1282b15978290327b8f630dd9aa28886">m_bPrintFrequencies_linear_elasticity</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ad9e6ad3ee0fc5f7bc40af2b72f35d409">  149</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ad9e6ad3ee0fc5f7bc40af2b72f35d409">m_bAbortOnFreqConverged_linear_elasticity</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a31e6c16cfe328c08fb74c6cb102168c2">  150</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a31e6c16cfe328c08fb74c6cb102168c2">m_dFreqPrecision</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a5603bf094576f226bd2d747ceca607d6">  152</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a5603bf094576f226bd2d747ceca607d6">m_bPrintEigenvaluesAndDefect</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ac3e8733b87612508126bcdaa64909618">  153</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ac3e8733b87612508126bcdaa64909618">m_bPrintProjectedEigenvalues</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ad982a5671eb0303e64e0575b20e99a7f">  154</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ad982a5671eb0303e64e0575b20e99a7f">m_bPrintProjectedEigenvectors</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ab43c1be96a7545cb39d4ac9a6ffed6cc">  155</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ab43c1be96a7545cb39d4ac9a6ffed6cc">m_bPrintProjectedEigenproblem</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#aa8abe54c08e78fa77b2d07f55859fe60">  156</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#aa8abe54c08e78fa77b2d07f55859fe60">m_bPrintUsedTestvectors</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a70552f3e2c0de67c35911a410c66e6fb">  157</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a70552f3e2c0de67c35911a410c66e6fb">m_bUseAdditionalCorrections</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#af016687f336e2bfec313c6f3f13037d6">  158</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#af016687f336e2bfec313c6f3f13037d6">m_bDebugCalcProjectedEigenvalues</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a7432e063685e7e51672025a53e012105">  159</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a7432e063685e7e51672025a53e012105">m_additionalEigenvectorsToKeep</a>;</div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a2cd0c60689ea9ff2ce1a399b1bf428ef">  160</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a2cd0c60689ea9ff2ce1a399b1bf428ef">m_currentAdditionalEigenvectors</a>;</div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a02d2fe8192fa7199dfb1abbe30f0ffc1">  161</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a02d2fe8192fa7199dfb1abbe30f0ffc1">m_currentAdditionalCorrections</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a3d282a8faa1f9098057f343f784fa24c">  164</a></span>&#160;  std::string <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a3d282a8faa1f9098057f343f784fa24c">tostring</a>()</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ab3af1cf6e271a41548f019aaa82adcf2">config_string</a>();</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ab3af1cf6e271a41548f019aaa82adcf2">  168</a></span>&#160;  <span class="keyword">virtual</span> std::string <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ab3af1cf6e271a41548f019aaa82adcf2">config_string</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;PINVIT Eigensolver by Martin Rupp / G-CSC 2013-2015.&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="stringliteral">&quot;\n MaxIterations = &quot;</span> &lt;&lt; <a class="code" href="classug_1_1_p_i_n_v_i_t.html#aa77dadc26f6be3f2beee8078c18415e3">m_maxIterations</a> &lt;&lt;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="stringliteral">&quot;\n Precision = &quot;</span> &lt;&lt; <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a6b3bdd607dfe9e438a3f607883ebe8fb">m_dPrecision</a> &lt;&lt; (<a class="code" href="classug_1_1_p_i_n_v_i_t.html#a0c28c878f414b6563282f0eb819a658a">m_bRelativePrecision</a> ? <span class="stringliteral">&quot; (relative) &quot;</span> : <span class="stringliteral">&quot; (absolute) &quot;</span>) &lt;&lt;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="stringliteral">&quot;\n MinimumDefectToCalcCorrection = &quot;</span> &lt;&lt; <a class="code" href="classug_1_1_p_i_n_v_i_t.html#af24635ed0789813f7eb2df2377600144">m_dMinimumDefectToCalcCorrection</a> &lt;&lt;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="stringliteral">&quot;\n Number of EV = &quot;</span> &lt;&lt; <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ad947a96e0f668b16dc2b6dd7c7637e96">px</a>.size() &lt;&lt;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="stringliteral">&quot;\n PINVIT = &quot;</span> &lt;&lt; <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a6d51438c950df0b23f8dfeb3e8d8c61e">m_iPINVIT</a> &lt;&lt; <span class="stringliteral">&quot; = &quot;</span>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classug_1_1_p_i_n_v_i_t.html#a6d51438c950df0b23f8dfeb3e8d8c61e">m_iPINVIT</a> == 1)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;       ss &lt;&lt; <span class="stringliteral">&quot;Preconditioned Inverse Block Iteration [Neymeyr]&quot;</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classug_1_1_p_i_n_v_i_t.html#a6d51438c950df0b23f8dfeb3e8d8c61e">m_iPINVIT</a>==2) ss &lt;&lt; <span class="stringliteral">&quot;Preconditioned Block Gradient Method&quot;</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classug_1_1_p_i_n_v_i_t.html#a6d51438c950df0b23f8dfeb3e8d8c61e">m_iPINVIT</a>==3) ss &lt;&lt; <span class="stringliteral">&quot;LOBPCG (locally optimal block preconditioned gradient) [Knyazew]&quot;</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classug_1_1_p_i_n_v_i_t.html#a6d51438c950df0b23f8dfeb3e8d8c61e">m_iPINVIT</a>&gt;=4) ss &lt;&lt; <span class="stringliteral">&quot;gerneralized method PINVIT-method looking back &quot;</span> &lt;&lt; <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a6d51438c950df0b23f8dfeb3e8d8c61e">m_iPINVIT</a>-1 &lt;&lt; <span class="stringliteral">&quot; ev approximations.&quot;</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;\n Preconditioner: &quot;</span>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classug_1_1_p_i_n_v_i_t.html#a1a307a01ba61faa783f789b54ca18528">m_spPrecond</a>.valid()) ss &lt;&lt; <a class="code" href="namespaceug.html#a085c53799397d7f152f03ade000d2baa">ConfigShift</a>(<a class="code" href="classug_1_1_p_i_n_v_i_t.html#a1a307a01ba61faa783f789b54ca18528">m_spPrecond</a>-&gt;config_string()) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">else</span> ss &lt;&lt; <span class="stringliteral">&quot;  NOT SET!\n&quot;</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classug_1_1_p_i_n_v_i_t.html#a7432e063685e7e51672025a53e012105">m_additionalEigenvectorsToKeep</a>&gt;0)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      ss &lt;&lt; <span class="stringliteral">&quot;\n\tAdditionaly storing &quot;</span> &lt;&lt; <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a7432e063685e7e51672025a53e012105">m_additionalEigenvectorsToKeep</a> &lt;&lt; <span class="stringliteral">&quot; eigenvectors&quot;</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classug_1_1_p_i_n_v_i_t.html#a70552f3e2c0de67c35911a410c66e6fb">m_bUseAdditionalCorrections</a>)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      ss &lt;&lt; <span class="stringliteral">&quot;\n\tUsing additional Corrections.&quot;</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classug_1_1_p_i_n_v_i_t.html#a8adfcf43fe55d8b7a5a404d05c6aae04">m_bLaplacian</a>)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      ss &lt;&lt; <span class="stringliteral">&quot;\n\tUsing LAPLACIAN!&quot;</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">return</span> ss.str();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ae3e6f3286a16abaf4cd3c9c658c9d4ec">  200</a></span>&#160;  <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ae3e6f3286a16abaf4cd3c9c658c9d4ec">PINVIT</a>()</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a3d00f979c3c39acf3b5a8b414fbd24df">m_pA</a> = <a class="code" href="group__ugbase__common__util.html#gaaf72bcd4f74729e4a43694267e8590d8">SPNULL</a>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a41e0d6a7931895c7ea09b5bc7e5e3ecd">m_pB</a> = NULL;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a6d51438c950df0b23f8dfeb3e8d8c61e">m_iPINVIT</a> = 3;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#af24635ed0789813f7eb2df2377600144">m_dMinimumDefectToCalcCorrection</a> = 1e-8;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a6b3bdd607dfe9e438a3f607883ebe8fb">m_dPrecision</a> = 1e-8;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a5603bf094576f226bd2d747ceca607d6">m_bPrintEigenvaluesAndDefect</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ac3e8733b87612508126bcdaa64909618">m_bPrintProjectedEigenvalues</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ad982a5671eb0303e64e0575b20e99a7f">m_bPrintProjectedEigenvectors</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ab43c1be96a7545cb39d4ac9a6ffed6cc">m_bPrintProjectedEigenproblem</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#aa8abe54c08e78fa77b2d07f55859fe60">m_bPrintUsedTestvectors</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a70552f3e2c0de67c35911a410c66e6fb">m_bUseAdditionalCorrections</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#af016687f336e2bfec313c6f3f13037d6">m_bDebugCalcProjectedEigenvalues</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a7432e063685e7e51672025a53e012105">m_additionalEigenvectorsToKeep</a> = 0;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a2cd0c60689ea9ff2ce1a399b1bf428ef">m_currentAdditionalEigenvectors</a> = 0;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a66c9acb0d5e2895f37db77b40d209da5">m_linearDependentEps</a> = 1e-6;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a8adfcf43fe55d8b7a5a404d05c6aae04">m_bLaplacian</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a58919091e957be3d8073217a3cf60dc9">m_bStoreDefects</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a9e8e493125d3054cd5e6c27abe945e57">m_bStoreLambdas</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a0c28c878f414b6563282f0eb819a658a">m_bRelativePrecision</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a66ad05e8732bab43e3eb90f8fa8124ed">m_dDensity_linear_elasticity</a> = 0.0;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a1282b15978290327b8f630dd9aa28886">m_bPrintFrequencies_linear_elasticity</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ad9e6ad3ee0fc5f7bc40af2b72f35d409">m_bAbortOnFreqConverged_linear_elasticity</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a31e6c16cfe328c08fb74c6cb102168c2">m_dFreqPrecision</a> = 0.0;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a3e5399f6cd1bdbbe7273532dd2b6757f">  230</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a3e5399f6cd1bdbbe7273532dd2b6757f">set_abort_on_frequencies_converged_linear_elasticity</a>(<span class="keywordtype">double</span> freq_precision, <span class="keywordtype">double</span> density)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a66ad05e8732bab43e3eb90f8fa8124ed">m_dDensity_linear_elasticity</a> = density;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a1282b15978290327b8f630dd9aa28886">m_bPrintFrequencies_linear_elasticity</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ad9e6ad3ee0fc5f7bc40af2b72f35d409">m_bAbortOnFreqConverged_linear_elasticity</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a31e6c16cfe328c08fb74c6cb102168c2">m_dFreqPrecision</a> = freq_precision;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a40fa915db8a428519c1dd3b6563f662e">  238</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a40fa915db8a428519c1dd3b6563f662e">set_linear_dependent_eps</a>(<span class="keywordtype">double</span> eps)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a66c9acb0d5e2895f37db77b40d209da5">m_linearDependentEps</a> = eps;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  }</div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a5eab4290dfb288d4edc031036280d227">  246</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a5eab4290dfb288d4edc031036280d227">add_vector</a>(<a class="code" href="class_smart_ptr.html">SmartPtr&lt;vector_type&gt;</a> vec)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ad947a96e0f668b16dc2b6dd7c7637e96">px</a>.push_back(vec);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a962def0ddf4c23d71ee7582d8521de39">  256</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a962def0ddf4c23d71ee7582d8521de39">set_preconditioner</a>(<a class="code" href="class_smart_ptr.html">SmartPtr</a>&lt;<a class="code" href="classug_1_1_i_linear_iterator.html">ILinearIterator&lt;vector_type&gt;</a> &gt; precond)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a1a307a01ba61faa783f789b54ca18528">m_spPrecond</a> = precond;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ad5d86f432b8aaa5d70296a5b7fd9e908">  261</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ad5d86f432b8aaa5d70296a5b7fd9e908">set_linear_operator_A</a>(<a class="code" href="class_smart_ptr.html">SmartPtr</a>&lt;<a class="code" href="classug_1_1_i_linear_operator.html">ILinearOperator&lt;vector_type&gt;</a> &gt; loA)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a3d00f979c3c39acf3b5a8b414fbd24df">m_pA</a> = loA;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// get dirichlet nodes</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="class_smart_ptr.html">SmartPtr&lt;MatrixOperator&lt;matrix_type, vector_type&gt;</a> &gt; pOp =</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a3d00f979c3c39acf3b5a8b414fbd24df">m_pA</a>.template cast_dynamic&lt;MatrixOperator&lt;matrix_type, vector_type&gt; &gt;();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="classug_1_1_debug_writing_object.html#a9d58db67544536cb42d1143434d95854">matrix_type</a> &amp;A = pOp-&gt;get_matrix();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a60650ba5bc7f1de117035aa3de4b4605">vbDirichlet</a>.resize(A.num_rows());</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classug_1_1_p_i_n_v_i_t.html#a8adfcf43fe55d8b7a5a404d05c6aae04">m_bLaplacian</a>)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keywordtype">bool</span> bFirst=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt;A.num_rows(); i++)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="comment">//vbDirichlet[i] = A.is_isolated(i);</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">if</span>(bFirst &amp;&amp; A.is_isolated(i))</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;          bFirst = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">typename</span> matrix_type::row_iterator it = A.begin_row(i); it != A.end_row(i); ++it)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          it.value() = -1.0;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        A(i, i) = A.num_connections(i)*1.0;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt;A.num_rows(); i++)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a60650ba5bc7f1de117035aa3de4b4605">vbDirichlet</a>[i] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt;A.num_rows(); i++)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a60650ba5bc7f1de117035aa3de4b4605">vbDirichlet</a>[i] = A.is_isolated(i);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a1dd6c1f82810f974f143fe913164f87b">  301</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a1dd6c1f82810f974f143fe913164f87b">set_linear_operator_B</a>(<a class="code" href="classug_1_1_matrix_operator.html">matrix_operator_type</a> &amp;B)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a41e0d6a7931895c7ea09b5bc7e5e3ecd">m_pB</a> = &amp;B;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ad05e29b7884a2d12d5e7476e189b5764">  306</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ad05e29b7884a2d12d5e7476e189b5764">set_max_iterations</a>(<span class="keywordtype">size_t</span> maxIterations)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#aa77dadc26f6be3f2beee8078c18415e3">m_maxIterations</a> = maxIterations;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#abcaa30a9e4ac7d04265bbf9feeae6651">  311</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#abcaa30a9e4ac7d04265bbf9feeae6651">set_precision</a>(<span class="keywordtype">double</span> precision)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a6b3bdd607dfe9e438a3f607883ebe8fb">m_dPrecision</a> = precision;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#af24635ed0789813f7eb2df2377600144">m_dMinimumDefectToCalcCorrection</a> = precision;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a0c28c878f414b6563282f0eb819a658a">m_bRelativePrecision</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ad56f3f49b7cf362cb267f8a3154f32cb">  318</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ad56f3f49b7cf362cb267f8a3154f32cb">set_additional_eigenvectors_to_keep</a>(<span class="keywordtype">size_t</span> i)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a7432e063685e7e51672025a53e012105">m_additionalEigenvectorsToKeep</a> = i;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a1a85282f08f8cfc14dfeb1eea6075098">  323</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a1a85282f08f8cfc14dfeb1eea6075098">set_debug_calc_projected_eigenvalues</a>(<span class="keywordtype">bool</span> b)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#af016687f336e2bfec313c6f3f13037d6">m_bDebugCalcProjectedEigenvalues</a> = b;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a216059a10eba7b194ed56480cda6daea">  328</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a216059a10eba7b194ed56480cda6daea">set_use_additional_corrections</a>(<span class="keywordtype">bool</span> b)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a70552f3e2c0de67c35911a410c66e6fb">m_bUseAdditionalCorrections</a> = b;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ac051bb396f2708713a529058d8a15c1f">  340</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#ac051bb396f2708713a529058d8a15c1f">set_pinvit</a>(<span class="keywordtype">size_t</span> iPINVIT)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a6d51438c950df0b23f8dfeb3e8d8c61e">m_iPINVIT</a> = iPINVIT;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="group__ugbase__common.html#ga0b928ef153b78f1b5e025638cf28f841">UG_ASSERT</a>(iPINVIT &gt;=1 &amp;&amp; iPINVIT &lt;= 3, &quot;i has to be &gt;= 1 and &lt;= 3, but is <span class="stringliteral">&quot; &lt;&lt; iPINVIT);</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00346"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a8ead1aeabe82cdc519f2a150893cbd8d">  346</a></span>&#160;<span class="stringliteral">  size_t num_eigenvalues()</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="stringliteral">    return px.size();</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a2dbe1bc05eeb4b9f008be259be417567">  351</a></span>&#160;<span class="stringliteral">  double get_eigenvalue(size_t i)</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="stringliteral">    if(lambda.size() != px.size()) return 0.0;</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="stringliteral">    return lambda[i];</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a399f5c2e1eeea86fa2a66cab8025dcba">  357</a></span>&#160;<span class="stringliteral">  SmartPtr&lt;vector_type&gt; get_eigenvector(size_t i)</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="stringliteral">    return px[i];</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a739a18022ffe35319e9619997c1a17ed">  362</a></span>&#160;<span class="stringliteral">  void set_print_eigenvalues_and_defect(bool b)</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="stringliteral">    m_bPrintEigenvaluesAndDefect = b;</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a0089265b74a7e029c638243914ea8550">  367</a></span>&#160;<span class="stringliteral">  void set_print_projected_eigenvectors(bool b)</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="stringliteral">    m_bPrintProjectedEigenvectors = b;</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a696aa3cfdad26caec24a5248111a47ec">  371</a></span>&#160;<span class="stringliteral">  void set_print_projected_eigenvalues(bool b)</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="stringliteral">    m_bPrintProjectedEigenvalues = b;</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a09dbc9a95e7385b54796c5d868dae6e4">  376</a></span>&#160;<span class="stringliteral">  void set_print_projected_eigenproblem(bool b)</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="stringliteral">    m_bPrintProjectedEigenproblem = b;</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ac01236c8d245aa47a1a151af7201dd28">  381</a></span>&#160;<span class="stringliteral">  void set_print_used_testvectors(bool b)</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="stringliteral">    m_bPrintUsedTestvectors = b;</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#abe5845d657b14b5c8bd3b4425feac1a1">  386</a></span>&#160;<span class="stringliteral">  void print_projected_eigenvectors(DenseMatrix&lt;VariableArray2&lt;double&gt; &gt; &amp;r_ev, std::vector&lt;std::complex&lt;double&gt; &gt; &amp;r_lambda, std::vector&lt;std::string&gt; &amp;vTestVectorDescription)</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="stringliteral">    UG_LOG(&quot;</span>evs: \n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="stringliteral">    for(size_t c=0; c &lt; r_ev.num_cols(); c++)</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="stringliteral">    {</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="stringliteral">      UG_LOG(&quot;</span>eigenvalue [<span class="stringliteral">&quot; &lt;&lt; c &lt;&lt; &quot;</span>] =  <span class="stringliteral">&quot; &lt;&lt; r_lambda[c] &lt;&lt; &quot;</span>, vector:\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="stringliteral">      std::vector&lt;double&gt; tmpEV(r_ev.num_rows());</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="stringliteral">      for(size_t r=0; r&lt;r_ev.num_rows(); r++)</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="stringliteral">        tmpEV[r] = r_ev(r, c);</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="stringliteral">      std::vector&lt;size_t&gt; s = GetSortedIndices(tmpEV, absCompare);</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="stringliteral">      for(size_t i=0; i&lt;r_ev.num_rows(); i++)</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="stringliteral">      {</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="stringliteral">        //if(r_ev.num_rows() &gt; 3 &amp;&amp; abs(r_ev(s[i], c))/abs(r_ev(s[r_ev.num_rows()-1], c)) &lt; 0.01) continue;</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="stringliteral">        size_t j = s[i];</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="stringliteral">        UG_LOG(std::setw(14) &lt;&lt; r_ev(j, c) &lt;&lt; &quot;</span>   <span class="stringliteral">&quot; &lt;&lt; vTestVectorDescription[j] &lt;&lt; &quot;</span>\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="stringliteral">      UG_LOG(&quot;</span>\n\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#aeaf36feeaca29dcb96ae5d881f18b617">  410</a></span>&#160;<span class="stringliteral">  SmartPtr&lt;vector_type&gt; create_approximation_vector()</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="stringliteral">    SmartPtr&lt;vector_type&gt; t = px(0).clone_without_values();</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="stringliteral">    t-&gt;set(0.0);</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="stringliteral">    return t;</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a0a424e98659cf49c345a6f57e390f63d">  417</a></span>&#160;<span class="stringliteral">  void set_store_defects(bool b)</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="stringliteral">    m_bStoreDefects = b;</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a671fc034ebd04b9596815d1cc8d016e1">  422</a></span>&#160;<span class="stringliteral">  void set_store_lambdas(bool b)</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="stringliteral">    m_bStoreLambdas = b;</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a58919091e957be3d8073217a3cf60dc9">  427</a></span>&#160;<span class="stringliteral">  bool m_bStoreDefects;</span></div>
<div class="line"><a name="l00428"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a9e8e493125d3054cd5e6c27abe945e57">  428</a></span>&#160;<span class="stringliteral">  bool m_bStoreLambdas;</span></div>
<div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a34ffebd316c14da8c05d9a62857baf1e">  429</a></span>&#160;<span class="stringliteral">  size_t m_iteration;</span></div>
<div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a3231460ee93f1d82bdee3fd4a435163f">  430</a></span>&#160;<span class="stringliteral">  std::vector&lt;std::vector&lt;double&gt; &gt; m_defects;</span></div>
<div class="line"><a name="l00431"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a6a4fc9895c0efa1725f32dd61cf45a21">  431</a></span>&#160;<span class="stringliteral">  std::vector&lt;std::vector&lt;double&gt; &gt; m_lambdas;</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00433"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ae7d79411bc80a1754b1c9662246b29ba">  433</a></span>&#160;<span class="stringliteral">  size_t get_iterations()</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="stringliteral">    return m_iteration;</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ae86e330fda35998e7195587841845e57">  438</a></span>&#160;<span class="stringliteral">  double get_defect(size_t nev, size_t it)</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="stringliteral">    UG_COND_THROW(m_bStoreDefects == false, &quot;</span>Not storing defects. Use <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a0a424e98659cf49c345a6f57e390f63d">set_store_defects</a>(<span class="keyword">true</span>).<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="stringliteral">    UG_COND_THROW(nev &gt; m_defects.size(), nev &lt;&lt; &quot;</span> &gt; #EV<span class="stringliteral">&quot; &lt;&lt; m_defects.size());</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="stringliteral">    UG_COND_THROW(it &gt; m_defects[nev].size(), &quot;</span>Iteration <span class="stringliteral">&quot; &lt;&lt; it &lt;&lt; &quot;</span> not available.<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="stringliteral">    return m_defects[nev][it];</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#acd9be099de28755b4149a8cb1b8d0047">  446</a></span>&#160;<span class="stringliteral">  double get_lambda(size_t nev, size_t it)</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="stringliteral">    UG_COND_THROW(m_bStoreLambdas == false, &quot;</span>Not storing lambdas. Use <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a671fc034ebd04b9596815d1cc8d016e1">set_store_lambdas</a>(<span class="keyword">true</span>).<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="stringliteral">    UG_COND_THROW(nev &gt; m_lambdas.size(), nev &lt;&lt; &quot;</span> &gt; #EV<span class="stringliteral">&quot; &lt;&lt; m_lambdas.size());</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="stringliteral">    UG_COND_THROW(it &gt; m_lambdas[nev].size(), &quot;</span>Iteration <span class="stringliteral">&quot; &lt;&lt; it &lt;&lt; &quot;</span> not available.<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="stringliteral">    return m_lambdas[nev][it];</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a5a86451139cb994f3972e4f82ad08552">  459</a></span>&#160;<span class="stringliteral">  int apply()</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="stringliteral">    PINVIT_PROFILE_FUNC();</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="stringliteral">    UG_LOG(config_string() &lt;&lt; &quot;</span>\nInitializing... <span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="stringliteral">    size_t nEigenvalues = px.size();</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="stringliteral">    DenseMatrix&lt;VariableArray2&lt;double&gt; &gt; rA;</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="stringliteral">    DenseMatrix&lt;VariableArray2&lt;double&gt; &gt; rB;</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="stringliteral">    DenseMatrix&lt;VariableArray2&lt;double&gt; &gt; r_ev;</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="stringliteral">    std::vector&lt;std::complex&lt;double&gt; &gt; r_lambda;</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="stringliteral">    std::vector&lt;std::string&gt; vCorrectionName;</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="stringliteral">    SmartPtrVector&lt;vector_type&gt; pTestVectors;</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="stringliteral">    SmartPtrVector&lt;vector_type&gt; vAdditional;</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="stringliteral">    SmartPtrVector&lt;vector_type&gt; vCorr;</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="stringliteral">    SmartPtrVector&lt;vector_type&gt; vOldX;</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="stringliteral">    std::vector&lt;double&gt; vDefectNorm(nEigenvalues, m_dPrecision*10);</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="stringliteral">    std::vector&lt;double&gt; oldXnorm(nEigenvalues);</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="stringliteral">    std::vector&lt;bool&gt; bConverged(nEigenvalues, false);</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="stringliteral">    std::vector&lt;std::string&gt; vTestVectorDescription;</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="stringliteral">    SmartPtr&lt;vector_type&gt; spDefect;</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="stringliteral">    try{</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="stringliteral">      spDefect = create_approximation_vector();</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="stringliteral">      m_currentAdditionalEigenvectors = 0;</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="stringliteral">      //size_t size = px[0]-&gt;size();</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="stringliteral">      /*</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="stringliteral">      ParallelMatrix&lt;SparseMatrix&lt;double&gt; &gt; B;</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="stringliteral">      B.resize(size, size);</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="stringliteral">      for(size_t i=0; i&lt;size; i++)</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="stringliteral">        B(i,i) = 0.00390625;</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="stringliteral">      B.set_storage_type(PST_ADDITIVE);*/</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="stringliteral">      for(size_t i=0; i&lt;m_additionalEigenvectorsToKeep; i++)</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="stringliteral">        vAdditional.push_back(create_approximation_vector());</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="stringliteral">      lambda.resize(nEigenvalues);</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="stringliteral">      freq_change.resize(nEigenvalues);</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="stringliteral">      for(size_t i=0; i&lt;nEigenvalues; i++)</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="stringliteral">      {</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="stringliteral">        vCorr.push_back(create_approximation_vector() );</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="stringliteral">        if(m_iPINVIT &gt;= 3)</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="stringliteral">          vOldX.push_back(create_approximation_vector() );</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="stringliteral">      vCorrectionName.resize(nEigenvalues);</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="stringliteral">    }UG_CATCH_THROW(&quot;</span><a class="code" href="classug_1_1_p_i_n_v_i_t.html#a5a86451139cb994f3972e4f82ad08552">PINVIT::apply</a> <a class="codeRef" href="../plugins/group__small__strain__mechanics.html#gaf07906d860d20ad045f1718f42778749">init</a> vectors failed.<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="stringliteral">    UG_LOG(&quot;</span>done.\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="stringliteral">    UG_LOG(&quot;</span><a class="code" href="classug_1_1_p_i_n_v_i_t.html">PINVIT</a>: Initializing preconditioner... <span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="stringliteral">    try{</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="stringliteral">      m_spPrecond-&gt;init(m_pA);</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="stringliteral">    }UG_CATCH_THROW(&quot;</span><a class="code" href="classug_1_1_p_i_n_v_i_t.html#a5a86451139cb994f3972e4f82ad08552">PINVIT::apply</a> <a class="codeRef" href="../plugins/group__small__strain__mechanics.html#gaf07906d860d20ad045f1718f42778749">init</a> preconditioner.<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="stringliteral">    UG_LOG(&quot;</span>done.\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="stringliteral">#ifdef UG_PARALLEL</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="stringliteral">    pcl::ProcessCommunicator pc;</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="stringliteral">#endif</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="stringliteral">    m_iteration=0;</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="stringliteral">    m_defects.clear();</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="stringliteral">    if(m_bStoreDefects)</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="stringliteral">      m_defects.resize(nEigenvalues);</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="stringliteral">    m_lambdas.clear();</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="stringliteral">    if(m_bStoreLambdas)</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="stringliteral">      m_lambdas.resize(nEigenvalues);</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="stringliteral">    for(m_iteration=0; m_iteration&lt;m_maxIterations; m_iteration++)</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="stringliteral">    {</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="stringliteral">      try{</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="stringliteral">  //      UG_LOG(&quot;</span>normalize...\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="stringliteral">        // 0. normalize</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="stringliteral">        normalize_approximations();</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="stringliteral">        //  2. compute rayleigh quotient, residuum, apply preconditioner, compute corrections norm</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="stringliteral">        size_t nrofconverged=0;</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="stringliteral">        size_t currentAdditionalCorrections = 0;</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="stringliteral">        size_t numCorrections=0;</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="stringliteral">        PROGRESS_START(prog, nEigenvalues, &quot;</span><a class="code" href="classug_1_1_p_i_n_v_i_t.html">PINVIT</a>: <a class="code" href="conv__rates__kinetic_8lua.html#a67171a8de2a01179202fc9eb332a6444">compute</a> corrections<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="stringliteral">        for(size_t i=0; i&lt;nEigenvalues; i++)</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="stringliteral">        {</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="stringliteral">          PROGRESS_UPDATE(prog, i);</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="stringliteral">  //        UG_LOG(&quot;</span><a class="code" href="conv__rates__kinetic_8lua.html#a67171a8de2a01179202fc9eb332a6444">compute</a> rayleigh <span class="stringliteral">&quot; &lt;&lt; i &lt;&lt; &quot;</span>...\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="stringliteral">          double freq_old = 0;</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="stringliteral">          if(m_bPrintFrequencies_linear_elasticity){</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="stringliteral">            freq_old = 1.0/(2.0*PI)*sqrt(lambda[i]/m_dDensity_linear_elasticity);</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="stringliteral">          }</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="stringliteral">          compute_rayleigh_and_defect(px(i), lambda[i], *spDefect, vDefectNorm[i]);</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="stringliteral">          if(m_bPrintFrequencies_linear_elasticity){</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="stringliteral">            freq_change[i] = freq_old-1.0/(2.0*PI)*sqrt(lambda[i]/m_dDensity_linear_elasticity);</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="stringliteral">          }</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="stringliteral">          if((m_iteration != 0 &amp;&amp; m_bRelativePrecision &amp;&amp; vDefectNorm[i]/lambda[i] &lt; m_dPrecision)</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="stringliteral">              || (!m_bRelativePrecision &amp;&amp; vDefectNorm[i] &lt; m_dPrecision))</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="stringliteral">            bConverged[i] = true;</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="stringliteral">          else</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="stringliteral">            bConverged[i] = false;</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="stringliteral">          if(bConverged[i])</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="stringliteral">          {</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="stringliteral">            nrofconverged++;</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="stringliteral">            if(!m_bRelativePrecision &amp;&amp;</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="stringliteral">                m_bUseAdditionalCorrections &amp;&amp; currentAdditionalCorrections &lt; m_currentAdditionalEigenvectors)</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="stringliteral">            {</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="stringliteral">              double additionalLambda, additionalDefect;</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="stringliteral">              compute_rayleigh_and_defect(vAdditional(currentAdditionalCorrections),</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="stringliteral">                  additionalLambda, *spDefect, additionalDefect);</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="stringliteral">              currentAdditionalCorrections++;</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="stringliteral">              if(additionalDefect &gt; m_dPrecision &amp;&amp; additionalDefect &lt; 1e5)</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="stringliteral">              {</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="stringliteral">                calculate_correction(*vCorr[numCorrections++], *spDefect);</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="stringliteral">                vCorrectionName[numCorrections-1] = std::string(&quot;</span>additional correction <span class="stringliteral">&quot;) + ToString(currentAdditionalCorrections-1);</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="stringliteral">              }</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="stringliteral">          }</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="stringliteral">          else</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="stringliteral">          {</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="stringliteral">  //          UG_LOG(&quot;</span>Calculating correction from defect <span class="stringliteral">&quot; &lt;&lt; i &lt;&lt; &quot;</span>\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="stringliteral">            vCorrectionName[numCorrections] = std::string(&quot;</span>correction <span class="stringliteral">&quot;) + ToString(i);</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="stringliteral">            calculate_correction(*vCorr[numCorrections++], *spDefect);</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="stringliteral">          }</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="stringliteral">          if(m_bStoreDefects)</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="stringliteral">            m_defects[i].push_back(vDefectNorm[i]);</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="stringliteral">          if(m_bStoreLambdas)</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="stringliteral">            m_lambdas[i].push_back(lambda[i]);</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="stringliteral">        PROGRESS_FINISH(prog);</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="stringliteral">        // output</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="stringliteral">        if(m_bPrintEigenvaluesAndDefect)</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="stringliteral">          print_eigenvalues_and_defect(m_iteration, vDefectNorm, oldXnorm, lambda, bConverged);</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="stringliteral">        if(nrofconverged==nEigenvalues)</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="stringliteral">        {</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="stringliteral">          UG_LOG(&quot;</span>all eigenvectors converged\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="stringliteral">          return true;</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="stringliteral">        if(m_bAbortOnFreqConverged_linear_elasticity){</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="stringliteral">          bool s = true;</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="stringliteral">          for(unsigned k = 0; k &lt; freq_change.size(); ++k){</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="stringliteral">            if(abs(freq_change[k]) &gt;= m_dFreqPrecision){</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="stringliteral">              s = false;</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="stringliteral">              break;</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="stringliteral">          }</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="stringliteral">          if(s){</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="stringliteral">            UG_LOG(&quot;</span>all eigenvectors converged according to frequency change\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="stringliteral">            return true;</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="stringliteral">          }</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="stringliteral">        // 5. add Testvectors</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="stringliteral">        //UG_LOG(&quot;</span>5. add Testvectors\nEigenvalues<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="stringliteral">        get_testvectors(m_iteration, vCorr, vCorrectionName, numCorrections, vOldX, vAdditional, pTestVectors, vTestVectorDescription, bConverged);</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="stringliteral">        for(size_t i=0; i&lt;nEigenvalues; i++)</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="stringliteral">        {</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="stringliteral">          write_debug(m_iteration, i, px(i), *spDefect, vCorr(i), bConverged[i]);</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="stringliteral">          if(vOldX.size() &gt; i) write_debug_old(m_iteration, i, vOldX(i));</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="stringliteral">        /*for(size_t i=0; i&lt;vTestVectorDescription.size(); i++)</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="stringliteral">        { UG_LOG(vTestVectorDescription[i] &lt;&lt; &quot;</span>\nEigenvalues<span class="stringliteral">&quot;); } */</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="stringliteral">        // 5. compute reduced Matrices rA, rB</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="stringliteral">        if(pTestVectors.size() &lt; px.size()+1)</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="stringliteral">        {</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="stringliteral">          UG_LOG(&quot;</span>ERROR: Projected Spaces has Dimension <span class="stringliteral">&quot; &lt;&lt; pTestVectors.size() &lt;&lt; &quot;</span>, but we need at least <span class="stringliteral">&quot; &lt;&lt; px.size()+1 &lt;&lt; &quot;</span> to make progress (<span class="keywordflow">for</span> <span class="stringliteral">&quot; &lt;&lt; px.size() &lt;&lt; &quot;</span> eigenvalues)\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="stringliteral">          return false;</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="stringliteral">        get_projected_eigenvalue_problem(rA, rB, pTestVectors, vTestVectorDescription);</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="stringliteral">        // 6. solve reduced eigenvalue problem</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="stringliteral">        size_t iNrOfTestVectors = pTestVectors.size();</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="stringliteral">        r_ev.resize(iNrOfTestVectors, iNrOfTestVectors);</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="stringliteral">        r_lambda.resize(iNrOfTestVectors);</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="stringliteral">        // solve rA x = lambda rB, --&gt; r_ev, r_lambda</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="stringliteral">        GeneralizedEigenvalueProblemComplex(rA, r_ev, r_lambda, rB, true);</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="stringliteral">        if(m_bPrintProjectedEigenvalues)</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="stringliteral">          print_projected_eigenvectors(r_ev, r_lambda, vTestVectorDescription);</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="stringliteral">        if(m_bDebugCalcProjectedEigenvalues)</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="stringliteral">          debug_calc_projected_eigenvalues(r_ev, pTestVectors, m_iteration, false);</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="stringliteral">        set_new_approximations_and_save_old(r_ev, pTestVectors, vOldX, vAdditional);</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="stringliteral">        assert_real_positive(r_lambda);</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="stringliteral">      }UG_CATCH_THROW(&quot;</span><a class="code" href="classug_1_1_p_i_n_v_i_t.html#a5a86451139cb994f3972e4f82ad08552">PINVIT::apply</a> iteration <span class="stringliteral">&quot; &lt;&lt; m_iteration &lt;&lt; &quot;</span> failed.<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="stringliteral">    UG_LOG(&quot;</span>not converged after<span class="stringliteral">&quot; &lt;&lt; m_maxIterations &lt;&lt; &quot;</span> steps.\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="stringliteral">    return false;</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="stringliteral">  // only use this type of vector creation if you don&#39;t use the preconditioner</span></div>
<div class="line"><a name="l00681"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a1a3e8e15b3b60d71750eaccc660a0d9a">  681</a></span>&#160;<span class="stringliteral">  void init_nonprecond_vector(vector_type &amp;t)</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="stringliteral">    CloneVector(t, px(0));</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="stringliteral">    t.set(0.0);</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00693"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#abf2ba53fe4d2cbd0ca45e1700a47310c">  693</a></span>&#160;<span class="stringliteral">  void debug_calc_projected_eigenvalues(DenseMatrix&lt;VariableArray2&lt;double&gt; &gt; &amp;r_ev,</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="stringliteral">      SmartPtrVector&lt;vector_type&gt; &amp;pTestVectors, int iteration, bool bWrite)</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="stringliteral">    PROFILE_FUNC_GROUP(&quot;</span>debug<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="stringliteral">    try{</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="stringliteral">      if(debug_writer() == SPNULL) return;</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="stringliteral">      vector_type t, defect;</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="stringliteral">      init_nonprecond_vector(t);</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="stringliteral">      init_nonprecond_vector(defect);</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="stringliteral">  #ifdef UG_PARALLEL</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="stringliteral">      for(size_t c=0; c&lt;pTestVectors.size(); c++)</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="stringliteral">        pTestVectors[c]-&gt;change_storage_type(PST_CONSISTENT);</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="stringliteral">  #endif</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="stringliteral">      for(size_t r=0; r&lt;pTestVectors.size(); r++)</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="stringliteral">      {</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="stringliteral">  #ifdef UG_PARALLEL</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="stringliteral">        t.set_storage_type(PST_CONSISTENT);</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="stringliteral">        defect.set_storage_type(PST_ADDITIVE);</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="stringliteral">  #endif</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="stringliteral">        for(size_t i=0; i&lt;t.size(); i++)</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="stringliteral">        {</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="stringliteral">          t[i] = 0.0;</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="stringliteral">          if(!vbDirichlet[i])</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="stringliteral">          {</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="stringliteral">            for(size_t c=0; c&lt;pTestVectors.size(); c++)</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="stringliteral">              t[i] += r_ev(c, r) * (*pTestVectors[c])[i];</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="stringliteral">          }</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="stringliteral">        t *= 1.0/B_norm(t);</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="stringliteral">  #ifdef UG_PARALLEL</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="stringliteral">        t.set_storage_type(PST_CONSISTENT);</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="stringliteral">        defect.set_storage_type(PST_ADDITIVE);</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="stringliteral">  #endif</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="stringliteral">        m_pA-&gt;apply(defect, t);</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="stringliteral">        double lambda = t.dotprod(defect);</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="stringliteral">        if(m_pB)</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="stringliteral">        {</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="stringliteral">  #ifdef UG_PARALLEL</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="stringliteral">          defect.change_storage_type(PST_ADDITIVE);</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="stringliteral">          t.change_storage_type(PST_CONSISTENT);</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="stringliteral">  #endif</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="stringliteral">          MatMultAdd(defect, 1.0, defect, -lambda, *m_pB, t);</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="stringliteral">        else</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="stringliteral">          VecScaleAdd(defect, 1.0, defect, -lambda, t);</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="stringliteral">        UG_LOG(r &lt;&lt; &quot;</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a7f43af63812849e8a78015b43d0ddb53">lambda</a>: <span class="stringliteral">&quot; &lt;&lt; std::setw(14) &lt;&lt; lambda &lt;&lt; &quot;</span> defect: <span class="stringliteral">&quot; &lt;&lt; std::setw(14) &lt;&lt; defect.norm() &lt;&lt; &quot;</span>\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="stringliteral">        if(bWrite)</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="stringliteral">          write_debug(t, (&quot;</span>pinvit_it_<span class="stringliteral">&quot; + ToString(iteration) + &quot;</span>_pev_<span class="stringliteral">&quot; + ToString(r)).c_str());</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="stringliteral">    }UG_CATCH_THROW(&quot;</span><a class="code" href="classug_1_1_p_i_n_v_i_t.html#abf2ba53fe4d2cbd0ca45e1700a47310c">PINVIT::debug_calc_projected_eigenvalues</a> failed.<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00758"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a1acd4e8e8f82a4f8ec948a07f23981c3">  758</a></span>&#160;<span class="stringliteral">  void set_new_approximations_and_save_old(DenseMatrix&lt;VariableArray2&lt;double&gt; &gt; &amp;r_ev, SmartPtrVector&lt;vector_type&gt; &amp;pTestVectors, SmartPtrVector&lt;vector_type&gt; &amp;vOldX,</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="stringliteral">      SmartPtrVector&lt;vector_type&gt; &amp;vAdditional)</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="stringliteral">    PINVIT_PROFILE_FUNC();</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="stringliteral">    try{</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="stringliteral">  #ifdef UG_PARALLEL</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="stringliteral">      for(size_t i=0; i&lt;pTestVectors.size(); i++)</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="stringliteral">        pTestVectors[i]-&gt;change_storage_type(PST_CONSISTENT);</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="stringliteral">      for(size_t i=0; i&lt;px.size(); i++)</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="stringliteral">        px[i]-&gt;change_storage_type(PST_CONSISTENT);</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="stringliteral">      for(size_t i=0; i&lt;vOldX.size(); i++)</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="stringliteral">        vOldX[i]-&gt;set_storage_type(PST_CONSISTENT);</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="stringliteral">      for(size_t i=0; i&lt;vAdditional.size(); i++)</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="stringliteral">        vAdditional[i]-&gt;set_storage_type(PST_CONSISTENT);</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="stringliteral">  #endif</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="stringliteral">      // assume r_lambda is sorted</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="stringliteral">      size_t size = px[0]-&gt;size();</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="stringliteral">      THROW_IF_NOT_EQUAL(pTestVectors.size(), r_ev.num_rows());</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="stringliteral">      size_t numCalc = std::min(px.size()+m_additionalEigenvectorsToKeep, r_ev.num_cols()); //px.size()</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="stringliteral">      m_currentAdditionalEigenvectors = numCalc-px.size();</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="stringliteral">  //    UG_LOG(&quot;</span>current aditional eigenvectors: <span class="stringliteral">&quot; &lt;&lt; m_currentAdditionalEigenvectors &lt;&lt; &quot;</span>\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="stringliteral">      std::vector&lt;vector_value_type&gt; x_tmp(numCalc);</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="stringliteral">      for(size_t i=0; i&lt;size; i++)</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="stringliteral">      {</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="stringliteral">        if(vbDirichlet[i]) continue;</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="stringliteral">        // since vx can be part of the Testvectors, temporary safe result in x_tmp.</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="stringliteral">        for(size_t r=0; r &lt; numCalc; r++)</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="stringliteral">        {</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="stringliteral">          x_tmp[r] = 0.0;</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="stringliteral">          for(size_t c=0; c&lt;pTestVectors.size(); c++)</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="stringliteral">            x_tmp[r] += r_ev(c, r) * (*pTestVectors[c])[i];</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="stringliteral">        // now overwrite</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="stringliteral">        for(size_t r=0; r&lt;px.size(); r++)</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="stringliteral">        {</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="stringliteral">          // save old</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="stringliteral">          /*for(int k=0; k&lt;m_nrOfOld; k++)</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="stringliteral">            vOldX[k][r][i] = vOldX[k][r][i];</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="stringliteral">          vOldX[0][r][i] = (px[r])[i];*/</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="stringliteral">          if(vOldX.size()&gt;0)</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="stringliteral">            vOldX(r) [i] = px(r) [i];</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="stringliteral">          // store new</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="stringliteral">          px(r) [i] = x_tmp[r];</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="stringliteral">        // store additional</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="stringliteral">        for(size_t r=px.size(); r&lt;numCalc; r++)</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="stringliteral">          vAdditional(r-px.size()) [i] = x_tmp[r];</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="stringliteral">    }UG_CATCH_THROW(&quot;</span><a class="code" href="classug_1_1_p_i_n_v_i_t.html#a1acd4e8e8f82a4f8ec948a07f23981c3">PINVIT::set_new_approximations_and_save_old</a> failed.<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00818"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ac35647bdd92c618c3ae58d30a0ca0382">  818</a></span>&#160;<span class="stringliteral">  void assert_real_positive(const std::vector&lt;std::complex&lt;double&gt; &gt; &amp;r_lambda)</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="stringliteral">    PINVIT_PROFILE_FUNC();</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="stringliteral">    try{</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="stringliteral">      //#define UG_ASSERT2(cond, txt) {if(!cond) { UG_LOG(&quot;</span>Warning: <span class="stringliteral">&quot; &lt;&lt; txt &lt;&lt; &quot;</span>\n<span class="stringliteral">&quot;); }}</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="stringliteral">      for(size_t i=0; i&lt;r_lambda.size(); i++) // px.size() or r_lambda.size()</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="stringliteral">      {</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="stringliteral">        if(r_lambda[i].imag() &gt;= 1e-8)</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="stringliteral">          {UG_LOG(&quot;</span>WARNING: eigenvalue <span class="stringliteral">&quot; &lt;&lt; i &lt;&lt; &quot;</span> is imaginary (<span class="stringliteral">&quot; &lt;&lt; r_lambda[i] &lt;&lt; &quot;</span>)\n<span class="stringliteral">&quot;); }</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="stringliteral">        if(r_lambda[i].real() &lt;= 1e-8)</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="stringliteral">          {UG_LOG(&quot;</span>WARNING: eigenvalues <span class="stringliteral">&quot; &lt;&lt; i &lt;&lt; &quot;</span>&lt;= 0\n<span class="stringliteral">&quot;);}</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="stringliteral">      if(m_bPrintProjectedEigenvalues &amp;&amp; m_bPrintProjectedEigenvectors == false)</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="stringliteral">      {</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="stringliteral">        for(size_t i=0; i&lt;r_lambda.size(); i++)</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="stringliteral">          UG_LOG(i &lt;&lt; &quot;</span>.: <span class="stringliteral">&quot; &lt;&lt; r_lambda[i] &lt;&lt; &quot;</span>\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="stringliteral">        UG_LOG(&quot;</span>\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="stringliteral">      for(size_t i=0; i&lt;r_lambda.size(); i++) // px.size() or r_lambda.size()</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="stringliteral">      {</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="stringliteral">        UG_ASSERT(r_lambda[i].imag() &lt; 1e-4 &amp;&amp; r_lambda[i].imag() &gt; -1e-4, &quot;</span>eigenvalue <span class="stringliteral">&quot; &lt;&lt; i &lt;&lt; &quot;</span> = <span class="stringliteral">&quot; &lt;&lt; r_lambda[i] &lt;&lt; &quot;</span> is imaginary (<span class="stringliteral">&quot; &lt;&lt; r_lambda[i] &lt;&lt; &quot;</span>)\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="stringliteral">        UG_ASSERT(r_lambda[i].real() &gt; -1e-4, &quot;</span>eigenvalues <span class="stringliteral">&quot; &lt;&lt; i &lt;&lt; &quot;</span> = <span class="stringliteral">&quot; &lt;&lt; r_lambda[i] &lt;&lt; &quot;</span> &lt; 0\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="stringliteral">    }UG_CATCH_THROW(&quot;</span><a class="code" href="classug_1_1_p_i_n_v_i_t.html#ac35647bdd92c618c3ae58d30a0ca0382">PINVIT::assert_real_positive</a> failed.<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00848"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a41977265e315aaa896c315e8d7715fb4">  848</a></span>&#160;<span class="stringliteral">  void get_max_deflection_of_a_mode(vector_type&amp; maxDeflect, vector_type&amp; statSol,</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="stringliteral">      const vector_type&amp; eigenVec, const matrix_type&amp; massMat)</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="stringliteral">    PINVIT_PROFILE_FUNC();</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="stringliteral">#ifdef UG_PARALLEL</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="stringliteral">    statSol.set_storage_type(PST_CONSISTENT);</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="stringliteral">    maxDeflect.set_storage_type(PST_CONSISTENT);</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="stringliteral">#endif</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="stringliteral">    SmartPtr&lt;vector_type&gt; Bv = statSol.clone_without_values();</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="stringliteral">    SmartPtr&lt;vector_type&gt; vwBv = statSol.clone_without_values();</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="stringliteral">    //  compute Bv = massMat * eigenVec;</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="stringliteral">    massMat.axpy(*Bv, 0.0, eigenVec, 1.0, eigenVec);</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="stringliteral">    //  vwBv = eigenVec * &lt; statSol, Bv &gt;</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="stringliteral">    number scalarProd = 0.0;</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="stringliteral">    for(size_t i = 0; i &lt; statSol.size(); i++)</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="stringliteral">      scalarProd += VecProd((*Bv)[i], statSol[i]);</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="stringliteral">    for(size_t i = 0; i &lt; statSol.size(); i++)</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="stringliteral">    {</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="stringliteral">      (*vwBv)[i] = eigenVec[i] * (-1.0) * scalarProd;</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="stringliteral">      //  maxDeflect += vwBv</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="stringliteral">      maxDeflect[i] = maxDeflect[i] + (*vwBv)[i];</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="stringliteral">private:</span></div>
<div class="line"><a name="l00878"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a89318a1b06e9e8b158a0e0cef308282a">  878</a></span>&#160;<span class="stringliteral">  void write_debug(int iteration, int i, vector_type &amp;x, vector_type &amp;defect, vector_type &amp;corr, bool bConverged)</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="stringliteral">    PROFILE_FUNC_GROUP(&quot;</span>debug<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="stringliteral">    write_debug(x, (&quot;</span>pinvit_it_<span class="stringliteral">&quot; + ToString(iteration) + &quot;</span>_ev_<span class="stringliteral">&quot; + ToString(i)).c_str());</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="stringliteral">    write_debug(defect, (&quot;</span>pinvit_it_<span class="stringliteral">&quot; + ToString(iteration) + &quot;</span>_defect_<span class="stringliteral">&quot; + ToString(i)).c_str());</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="stringliteral">    if(!bConverged)</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="stringliteral">      write_debug(corr, (&quot;</span>pinvit_it_<span class="stringliteral">&quot; + ToString(iteration) + &quot;</span>_corr_<span class="stringliteral">&quot; + ToString(i)).c_str());</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00887"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a193eb4cdc26d8605148b7d59798b20d0">  887</a></span>&#160;<span class="stringliteral">  void write_debug_old(int iteration, int i, vector_type &amp;oldX)</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="stringliteral">    write_debug(oldX, (&quot;</span>pinvit_it_<span class="stringliteral">&quot; + ToString(iteration) + &quot;</span>_old_<span class="stringliteral">&quot; + ToString(i)).c_str());</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00892"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a1479e62a9b1d9cf9f47df3693c85970d">  892</a></span>&#160;<span class="stringliteral">  double B_norm(vector_type &amp;x)</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="stringliteral">    PINVIT_PROFILE_FUNC();</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="stringliteral">    if(m_pB != NULL)</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="stringliteral">      return EnergyNorm(x, *m_pB);</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="stringliteral">    else</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="stringliteral">      return x.norm();</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00901"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a014c7dc396900b1a1111d66f121054f5">  901</a></span>&#160;<span class="stringliteral">  void normalize_approximations()</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="stringliteral">    PINVIT_PROFILE_FUNC();</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="stringliteral">    for(size_t i=0; i&lt; px.size(); i++)</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="stringliteral">      px(i) *= 1/ B_norm(px(i));</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00908"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a50ae98831dce8d0f07e2a84403dd885b">  908</a></span>&#160;<span class="stringliteral">  void calculate_correction(vector_type &amp;corr, vector_type &amp;defect)</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="stringliteral">    PINVIT_PROFILE_FUNC();</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="stringliteral">    try{</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="stringliteral">  #ifdef UG_PARALLEL</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="stringliteral">      defect.change_storage_type(PST_ADDITIVE);</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="stringliteral">      corr.set_storage_type(PST_CONSISTENT);</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="stringliteral">  #endif</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="stringliteral">      corr *= 0.0;</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="stringliteral">      // d. apply preconditioner</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="stringliteral">      if(1)</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="stringliteral">      {</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="stringliteral">        m_spPrecond-&gt;apply(corr, defect);</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="stringliteral">      else</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="stringliteral">      {</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="stringliteral">        m_spPrecond-&gt;apply_update_defect(corr, defect);</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="stringliteral">      corr *= 1/ B_norm(corr);</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="stringliteral">  #ifdef UG_PARALLEL</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="stringliteral">      corr.change_storage_type(PST_UNIQUE);</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="stringliteral">  #endif</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="stringliteral">    }UG_CATCH_THROW(&quot;</span><a class="code" href="classug_1_1_p_i_n_v_i_t.html#a50ae98831dce8d0f07e2a84403dd885b">PINVIT::calculate_correction</a> failed.<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00941"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#aed70c2b88ad60909a50e33c19d39b30d">  941</a></span>&#160;<span class="stringliteral">  void compute_rayleigh_and_defect(vector_type &amp;x, double &amp;lambda, vector_type &amp;defect, double &amp;defectNorm)</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="stringliteral">    PINVIT_PROFILE_FUNC();</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="stringliteral">    try{</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="stringliteral">  // a. compute rayleigh quotients</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="stringliteral">  #ifdef UG_PARALLEL</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="stringliteral">      x.change_storage_type(PST_CONSISTENT);</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="stringliteral">      defect.set_storage_type(PST_ADDITIVE);</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="stringliteral">  #endif</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="stringliteral">      m_pA-&gt;apply(defect, x);</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="stringliteral">  #ifdef UG_PARALLEL</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="stringliteral">      defect.change_storage_type(PST_UNIQUE);</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="stringliteral">      x.change_storage_type(PST_UNIQUE);</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="stringliteral">  #endif</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="stringliteral">      lambda = x.dotprod(defect); // / &lt;px[i], Bpx[i]&gt; = 1.0.</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="stringliteral">      //UG_LOG(&quot;</span>lambda[<span class="stringliteral">&quot; &lt;&lt; i &lt;&lt; &quot;</span>] = <span class="stringliteral">&quot; &lt;&lt; lambda &lt;&lt; &quot;</span>\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="stringliteral">  // b. calculate residuum</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="stringliteral">      // defect = A px[i] - lambda[i] B px[i]</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="stringliteral">      if(m_pB)</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="stringliteral">      {</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="stringliteral">  #ifdef UG_PARALLEL</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="stringliteral">        defect.change_storage_type(PST_ADDITIVE);</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="stringliteral">        x.change_storage_type(PST_CONSISTENT);</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="stringliteral">  #endif</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="stringliteral">        MatMultAdd(defect, 1.0, defect, -lambda, *m_pB, x);</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="stringliteral">      else</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="stringliteral">        VecScaleAdd(defect, 1.0, defect, -lambda, x);</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="stringliteral">  // c. check if converged</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="stringliteral">  #ifdef UG_PARALLEL</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="stringliteral">      defect.change_storage_type(PST_UNIQUE);</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="stringliteral">  #endif</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="stringliteral">      defectNorm = defect.norm();</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="stringliteral">    }UG_CATCH_THROW(&quot;</span><a class="code" href="classug_1_1_p_i_n_v_i_t.html#aed70c2b88ad60909a50e33c19d39b30d">PINVIT::compute_rayleigh_and_defect</a> failed.<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00992"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ab641f04f0b657165332755feadb2be12">  992</a></span>&#160;<span class="stringliteral">  void print_eigenvalues_and_defect(int iteration, const std::vector&lt;double&gt; &amp;vDefectNorm,</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="stringliteral">      std::vector&lt;double&gt; &amp;vOldDefectNorm, const std::vector&lt;double&gt; &amp;vLambda, std::vector&lt;bool&gt; &amp;bConverged)</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="stringliteral">    PINVIT_PROFILE_FUNC();</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="stringliteral">    UG_LOG(&quot;</span>=====================================================================================\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="stringliteral">    UG_LOG(&quot;</span>iteration <span class="stringliteral">&quot; &lt;&lt; iteration &lt;&lt; &quot;</span>\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="stringliteral">    for(size_t i=0; i&lt;vLambda.size(); i++)</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="stringliteral">    {</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="stringliteral">      UG_LOG(i &lt;&lt; &quot;</span> <a class="code" href="classug_1_1_p_i_n_v_i_t.html#a7f43af63812849e8a78015b43d0ddb53">lambda</a>: <span class="stringliteral">&quot; &lt;&lt; std::setw(20) &lt;&lt; vLambda[i]);</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="stringliteral">      if(m_bPrintFrequencies_linear_elasticity){</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="stringliteral">        UG_LOG(&quot;</span> freq: <span class="stringliteral">&quot; &lt;&lt; std::setw(20) &lt;&lt; 1.0/(2.0*PI)*sqrt(vLambda[i]/m_dDensity_linear_elasticity) );</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="stringliteral">        UG_LOG(&quot;</span> change: <span class="stringliteral">&quot; &lt;&lt; std::setw(20) &lt;&lt; freq_change[i]);</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="stringliteral">      UG_LOG(&quot;</span> defect: <span class="stringliteral">&quot; &lt;&lt; std::setw(20) &lt;&lt; vDefectNorm[i]);</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="stringliteral">      if(iteration != 0) { UG_LOG(&quot;</span> reduction: <span class="stringliteral">&quot; &lt;&lt; std::setw(14) &lt;&lt; vDefectNorm[i]/vOldDefectNorm[i]); }</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="stringliteral">      if(m_bPrintFrequencies_linear_elasticity &amp;&amp; abs(freq_change[i]) &lt; m_dFreqPrecision) { UG_LOG(&quot;</span> (freq. converged) <span class="stringliteral">&quot;); }</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="stringliteral">      if(bConverged[i]) { UG_LOG(&quot;</span> (converged)<span class="stringliteral">&quot;); }</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="stringliteral">      UG_LOG(&quot;</span>\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="stringliteral">      vOldDefectNorm[i] = vDefectNorm[i];</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="stringliteral">    UG_LOG(&quot;</span>\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01034"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#af348a5ffeb9a215ba119a36d4e6de4ce"> 1034</a></span>&#160;<span class="stringliteral">  void get_testvectors(int iteration, SmartPtrVector&lt;vector_type&gt; &amp;vCorr,</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="stringliteral">      std::vector&lt;std::string&gt; &amp;vCorrectionName,</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="stringliteral">      size_t numCorrections, SmartPtrVector&lt;vector_type&gt; &amp;vOldX, SmartPtrVector&lt;vector_type&gt; &amp;vAdditional,</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="stringliteral">      SmartPtrVector&lt;vector_type&gt; &amp;pTestVectors, std::vector&lt;std::string&gt; &amp;vTestVectorDescription,</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="stringliteral">      std::vector&lt;bool&gt; &amp;bConverged)</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="stringliteral">    try{</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="stringliteral">      PINVIT_PROFILE_FUNC();</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="stringliteral">      pTestVectors.clear();</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="stringliteral">      vTestVectorDescription.clear();</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="stringliteral">      if(m_iPINVIT == 1)</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="stringliteral">      {</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="stringliteral">        UG_ASSERT(0, &quot;</span>todo<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="stringliteral">        for(size_t i=0; i &lt; px.size(); i++)</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="stringliteral">        {</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="stringliteral">          if(!bConverged[i])</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="stringliteral">          {</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="stringliteral">            VecScaleAdd(vCorr(i), -1.0, vCorr(i), 1.0, px(i));</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="stringliteral">            vTestVectorDescription.push_back(std::string(&quot;</span>ev - vCorr [<span class="stringliteral">&quot;) + ToString(i) + std::string(&quot;</span>]<span class="stringliteral">&quot;) );</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="stringliteral">          }</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="stringliteral">      else</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="stringliteral">      {</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="stringliteral">        for(size_t i=0; i &lt; px.size(); i++)</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="stringliteral">        {</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="stringliteral">          if(IsFiniteAndNotTooBig(px(i)))</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="stringliteral">          {</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="stringliteral">            pTestVectors.push_back(px[i]);</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="stringliteral">            vTestVectorDescription.push_back(std::string(&quot;</span>eigenvector [<span class="stringliteral">&quot;) + ToString(i) + std::string(&quot;</span>]<span class="stringliteral">&quot;) );</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="stringliteral">            if(!bConverged[i] &amp;&amp; m_iPINVIT &gt;= 3)</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="stringliteral">            {</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="stringliteral">              if(iteration != 0)</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="stringliteral">              {</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="stringliteral">                UG_ASSERT(vOldX.size() &gt; i, &quot;</span>?<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="stringliteral">                pTestVectors.push_back(vOldX[i]);</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="stringliteral">                vTestVectorDescription.push_back(std::string(&quot;</span>old eigenvalue[<span class="stringliteral">&quot;) + ToString(i) + std::string(&quot;</span>]<span class="stringliteral">&quot;) );</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="stringliteral">              }</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="stringliteral">              /*if(iteration == 0)</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="stringliteral">              {</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="stringliteral">                for(size_t j=0; j&lt;px[i]-&gt;size(); j++)</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="stringliteral">                  vOldX[i][j] = (px[i])[j] * urand(-1.0, 1.0);</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="stringliteral">              }*/</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="stringliteral">          }</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="stringliteral">          else</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="stringliteral">          { UG_LOG(&quot;</span>WARNING ev [<span class="stringliteral">&quot; &lt;&lt; i &lt;&lt; &quot;</span>] not normal or too big\n<span class="stringliteral">&quot;); }</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="stringliteral">        for(size_t i=0; i&lt;numCorrections; i++)</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="stringliteral">        {</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="stringliteral">          if(IsFiniteAndNotTooBig(vCorr(i)))</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="stringliteral">          {</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="stringliteral">            pTestVectors.push_back(vCorr[i]);</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="stringliteral">            vTestVectorDescription.push_back(vCorrectionName[i]);</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="stringliteral">          }</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="stringliteral">          else</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="stringliteral">          {</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="stringliteral">            UG_LOG(&quot;</span>WARNING correction [<span class="stringliteral">&quot; &lt;&lt; i &lt;&lt; &quot;</span>] not normal or too big\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="stringliteral">          }</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="stringliteral">      for(size_t i=0; i&lt;m_currentAdditionalEigenvectors; i++)</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="stringliteral">      {</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="stringliteral">        if(IsFiniteAndNotTooBig(vAdditional(i)))</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="stringliteral">        {</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="stringliteral">          pTestVectors.push_back(vAdditional[i]);</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="stringliteral">          vTestVectorDescription.push_back(std::string(&quot;</span>additional [<span class="stringliteral">&quot;) + ToString(i) + std::string(&quot;</span>]<span class="stringliteral">&quot;) );</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="stringliteral">        else</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="stringliteral">        { UG_LOG(&quot;</span>WARNING additional [<span class="stringliteral">&quot; &lt;&lt; i &lt;&lt; &quot;</span>] not normal or too big\n<span class="stringliteral">&quot;); }</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="stringliteral">    }UG_CATCH_THROW(&quot;</span><a class="code" href="classug_1_1_p_i_n_v_i_t.html#af348a5ffeb9a215ba119a36d4e6de4ce">PINVIT::get_testvectors</a> failed.<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01118"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#aa73139f654e8a4986444479b1657e53c"> 1118</a></span>&#160;<span class="stringliteral">  void get_linear_independent_rows(DenseMatrix&lt;VariableArray2&lt;double&gt; &gt; mat, std::vector&lt;bool&gt; &amp;bLinearIndependent)</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="stringliteral">    PINVIT_PROFILE_FUNC();</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="stringliteral">    // Remove linear depended vectors</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="stringliteral">    bLinearIndependent.resize(mat.num_rows(), true);</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="stringliteral">    for(size_t i=0; i&lt;mat.num_rows(); i++)</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="stringliteral">    {</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="stringliteral">      for(size_t j=0; j&lt;i; j++)</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="stringliteral">      {</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="stringliteral">        if(!bLinearIndependent[i]) continue;</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="stringliteral">        double val = mat(i, j)/mat(j,j);</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="stringliteral">        mat(i,j) = 0;</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="stringliteral">        for(size_t k=j+1; k&lt;mat.num_rows(); k++)</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="stringliteral">          mat(i,k) -= val*mat(j, k);</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="stringliteral">      if(mat(i,i) &lt; m_linearDependentEps) bLinearIndependent[i] = false;</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="stringliteral">      else bLinearIndependent[i] = true;</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="stringliteral">  template&lt;typename T&gt;</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#aca275e4c9f29bc717c2e13d0deed4975"> 1144</a></span>&#160;<span class="stringliteral">  void remove_unused(T &amp;v, const std::vector&lt;bool&gt; vbUse)</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="stringliteral">    PINVIT_PROFILE_FUNC();</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="stringliteral">    T tmp;</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="stringliteral">    tmp = v;</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="stringliteral">    v.clear();</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="stringliteral">    for(size_t i=0; i&lt;tmp.size(); i++)</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="stringliteral">      if(vbUse[i])</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="stringliteral">        v.push_back(tmp[i]);</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01156"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#aab3f30e29ca4371239a94145139005e9"> 1156</a></span>&#160;<span class="stringliteral">  void print_used_testvectors(std::vector&lt;std::string&gt; &amp;vTestVectorDescription, std::vector&lt;bool&gt; bUse)</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="stringliteral">    UG_LOG(&quot;</span>used testvectors:\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="stringliteral">    for(size_t i=0; i&lt;vTestVectorDescription.size(); i++)</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="stringliteral">      if(bUse[i]) { UG_LOG(vTestVectorDescription[i] &lt;&lt; &quot;</span>\n<span class="stringliteral">&quot;); }</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="stringliteral">    UG_LOG(&quot;</span>unused testvectors:\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="stringliteral">    for(size_t i=0; i&lt;vTestVectorDescription.size(); i++)</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="stringliteral">      if(!bUse[i]) { UG_LOG(vTestVectorDescription[i] &lt;&lt; &quot;</span>\n<span class="stringliteral">&quot;); }</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01176"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#ad1ac607fa3463a6446bfcb663d6a5916"> 1176</a></span>&#160;<span class="stringliteral">  void get_projected_eigenvalue_problem(DenseMatrix&lt;VariableArray2&lt;double&gt; &gt; &amp;rA,</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="stringliteral">      DenseMatrix&lt;VariableArray2&lt;double&gt; &gt; &amp;rB, SmartPtrVector&lt;vector_type&gt; &amp;pTestVectors,</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="stringliteral">      std::vector&lt;std::string&gt; &amp;vTestVectorDescription)</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="stringliteral">    try{</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="stringliteral">      PINVIT_PROFILE_FUNC();</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="stringliteral">      // 1. calculate W as a subset of the testvectors so that those are linear B-independent</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="stringliteral">      size_t iNrOfTestVectors = pTestVectors.size();</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="stringliteral">      rA.resize(iNrOfTestVectors, iNrOfTestVectors);</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="stringliteral">      rB.resize(iNrOfTestVectors, iNrOfTestVectors);</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="stringliteral">      if(m_pB)</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="stringliteral">        MultiEnergyProd(*m_pB, pTestVectors, rB, iNrOfTestVectors);</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="stringliteral">      else</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="stringliteral">        MultiScalProd(pTestVectors, rB, iNrOfTestVectors);</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="stringliteral">      // Remove linear depended vectors</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="stringliteral">      std::vector&lt;bool&gt; bUse;</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="stringliteral">      get_linear_independent_rows(rB, bUse);</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="stringliteral">      if(m_bPrintUsedTestvectors)</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="stringliteral">        print_used_testvectors(vTestVectorDescription, bUse);</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="stringliteral">      // save used testvectors</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="stringliteral">      remove_unused(pTestVectors, bUse);</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="stringliteral">      remove_unused(vTestVectorDescription, bUse);</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="stringliteral">      iNrOfTestVectors = pTestVectors.size();</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="stringliteral">      // 2. &amp; 3. compute reduced Matrices rA, rB</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="stringliteral">      rA.resize(iNrOfTestVectors, iNrOfTestVectors);</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="stringliteral">      rB.resize(iNrOfTestVectors, iNrOfTestVectors);</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="stringliteral">  //    UG_LOG(&quot;</span>iNrOfTestVectors = <span class="stringliteral">&quot; &lt;&lt; iNrOfTestVectors &lt;&lt; &quot;</span>\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="stringliteral">      if(m_pB)</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="stringliteral">        MultiEnergyProd(*m_pB, pTestVectors, rB, iNrOfTestVectors);</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="stringliteral">      else</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="stringliteral">        MultiScalProd(pTestVectors, rB, iNrOfTestVectors);</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="stringliteral">      MultiEnergyProd(*m_pA, pTestVectors, rA, iNrOfTestVectors);</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="stringliteral">      if(m_bPrintProjectedEigenproblem)</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="stringliteral">      {</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="stringliteral">        PrintMaple(rA, &quot;</span>rA<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="stringliteral">        PrintMaple(rB, &quot;</span>rB<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="stringliteral">    }UG_CATCH_THROW(&quot;</span><a class="code" href="classug_1_1_p_i_n_v_i_t.html#ad1ac607fa3463a6446bfcb663d6a5916">PINVIT::get_projected_eigenvalue_problem</a> failed.<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="stringliteral">public:</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#aabac9421380db241063f48f9745e40a2"> 1230</a></span>&#160;<span class="stringliteral">  void set_laplacian(bool b)</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="stringliteral">    m_bLaplacian = b;</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01235"></a><span class="lineno"><a class="line" href="classug_1_1_p_i_n_v_i_t.html#a6f5479ac03653f2079bdcbf5cac9c873"> 1235</a></span>&#160;<span class="stringliteral">  void set_relative_precision(double precision)</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="stringliteral">  {</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="stringliteral">    m_dPrecision = precision;</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="stringliteral">    m_dMinimumDefectToCalcCorrection = precision;</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="stringliteral">    m_bRelativePrecision = true;</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="stringliteral">};</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="stringliteral">} // namespace ug</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="stringliteral">#endif // __H__UG__LIB_ALGEBRA__PINVIT_H__</span></div>
<div class="ttc" id="aclass_smart_ptr_html"><div class="ttname"><a href="class_smart_ptr.html">SmartPtr</a></div><div class="ttdef"><b>Definition:</b> smart_pointer.h:108</div></div>
<div class="ttc" id="aclassug_1_1_debug_writing_object_html"><div class="ttname"><a href="classug_1_1_debug_writing_object.html">ug::DebugWritingObject</a></div><div class="ttdef"><b>Definition:</b> debug_writer.h:354</div></div>
<div class="ttc" id="aclassug_1_1_debug_writing_object_html_a182b95496411d505fcb29b5381419131"><div class="ttname"><a href="classug_1_1_debug_writing_object.html#a182b95496411d505fcb29b5381419131">ug::DebugWritingObject::set_debug</a></div><div class="ttdeci">virtual void set_debug(SmartPtr&lt; IDebugWriter&lt; algebra_type &gt; &gt; spDebugWriter)</div><div class="ttdoc">set debug writer</div><div class="ttdef"><b>Definition:</b> debug_writer.h:384</div></div>
<div class="ttc" id="aclassug_1_1_debug_writing_object_html_a306270884f90183986354310a5be4ab5"><div class="ttname"><a href="classug_1_1_debug_writing_object.html#a306270884f90183986354310a5be4ab5">ug::DebugWritingObject::write_debug</a></div><div class="ttdeci">void write_debug(const matrix_type &amp;mat, const char *filename)</div><div class="ttdoc">write debug output for a matrix (if debug writer set)</div><div class="ttdef"><b>Definition:</b> debug_writer.h:399</div></div>
<div class="ttc" id="aclassug_1_1_debug_writing_object_html_a947b41828b12248936a9bc1e9b7463ae"><div class="ttname"><a href="classug_1_1_debug_writing_object.html#a947b41828b12248936a9bc1e9b7463ae">ug::DebugWritingObject::debug_writer</a></div><div class="ttdeci">SmartPtr&lt; IDebugWriter&lt; algebra_type &gt; &gt; debug_writer()</div><div class="ttdoc">returns the debug writer</div><div class="ttdef"><b>Definition:</b> debug_writer.h:391</div></div>
<div class="ttc" id="aclassug_1_1_debug_writing_object_html_a9d58db67544536cb42d1143434d95854"><div class="ttname"><a href="classug_1_1_debug_writing_object.html#a9d58db67544536cb42d1143434d95854">ug::DebugWritingObject::matrix_type</a></div><div class="ttdeci">TAlgebra::matrix_type matrix_type</div><div class="ttdoc">type of matrix</div><div class="ttdef"><b>Definition:</b> debug_writer.h:363</div></div>
<div class="ttc" id="aclassug_1_1_i_linear_iterator_html"><div class="ttname"><a href="classug_1_1_i_linear_iterator.html">ug::ILinearIterator</a></div><div class="ttdoc">describes a linear iterator</div><div class="ttdef"><b>Definition:</b> linear_iterator.h:81</div></div>
<div class="ttc" id="aclassug_1_1_i_linear_operator_html"><div class="ttname"><a href="classug_1_1_i_linear_operator.html">ug::ILinearOperator</a></div><div class="ttdoc">describes a linear mapping X-&gt;Y</div><div class="ttdef"><b>Definition:</b> linear_operator.h:80</div></div>
<div class="ttc" id="aclassug_1_1_matrix_operator_html"><div class="ttname"><a href="classug_1_1_matrix_operator.html">ug::MatrixOperator</a></div><div class="ttdef"><b>Definition:</b> matrix_operator.h:49</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html">ug::PINVIT</a></div><div class="ttdef"><b>Definition:</b> pinvit.h:104</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a02d2fe8192fa7199dfb1abbe30f0ffc1"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a02d2fe8192fa7199dfb1abbe30f0ffc1">ug::PINVIT::m_currentAdditionalCorrections</a></div><div class="ttdeci">size_t m_currentAdditionalCorrections</div><div class="ttdef"><b>Definition:</b> pinvit.h:161</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a0a424e98659cf49c345a6f57e390f63d"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a0a424e98659cf49c345a6f57e390f63d">ug::PINVIT::set_store_defects</a></div><div class="ttdeci">void set_store_defects(bool b)</div><div class="ttdef"><b>Definition:</b> pinvit.h:417</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a0c28c878f414b6563282f0eb819a658a"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a0c28c878f414b6563282f0eb819a658a">ug::PINVIT::m_bRelativePrecision</a></div><div class="ttdeci">bool m_bRelativePrecision</div><div class="ttdef"><b>Definition:</b> pinvit.h:137</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a1282b15978290327b8f630dd9aa28886"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a1282b15978290327b8f630dd9aa28886">ug::PINVIT::m_bPrintFrequencies_linear_elasticity</a></div><div class="ttdeci">bool m_bPrintFrequencies_linear_elasticity</div><div class="ttdef"><b>Definition:</b> pinvit.h:148</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a1a307a01ba61faa783f789b54ca18528"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a1a307a01ba61faa783f789b54ca18528">ug::PINVIT::m_spPrecond</a></div><div class="ttdeci">SmartPtr&lt; ILinearIterator&lt; vector_type &gt; &gt; m_spPrecond</div><div class="ttdef"><b>Definition:</b> pinvit.h:133</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a1a85282f08f8cfc14dfeb1eea6075098"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a1a85282f08f8cfc14dfeb1eea6075098">ug::PINVIT::set_debug_calc_projected_eigenvalues</a></div><div class="ttdeci">void set_debug_calc_projected_eigenvalues(bool b)</div><div class="ttdef"><b>Definition:</b> pinvit.h:323</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a1acd4e8e8f82a4f8ec948a07f23981c3"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a1acd4e8e8f82a4f8ec948a07f23981c3">ug::PINVIT::set_new_approximations_and_save_old</a></div><div class="ttdeci">void set_new_approximations_and_save_old(DenseMatrix&lt; VariableArray2&lt; double &gt; &gt; &amp;r_ev, SmartPtrVector&lt; vector_type &gt; &amp;pTestVectors, SmartPtrVector&lt; vector_type &gt; &amp;vOldX, SmartPtrVector&lt; vector_type &gt; &amp;vAdditional)</div><div class="ttdef"><b>Definition:</b> pinvit.h:758</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a1dd6c1f82810f974f143fe913164f87b"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a1dd6c1f82810f974f143fe913164f87b">ug::PINVIT::set_linear_operator_B</a></div><div class="ttdeci">void set_linear_operator_B(matrix_operator_type &amp;B)</div><div class="ttdef"><b>Definition:</b> pinvit.h:301</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a216059a10eba7b194ed56480cda6daea"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a216059a10eba7b194ed56480cda6daea">ug::PINVIT::set_use_additional_corrections</a></div><div class="ttdeci">void set_use_additional_corrections(bool b)</div><div class="ttdef"><b>Definition:</b> pinvit.h:328</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a2cd0c60689ea9ff2ce1a399b1bf428ef"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a2cd0c60689ea9ff2ce1a399b1bf428ef">ug::PINVIT::m_currentAdditionalEigenvectors</a></div><div class="ttdeci">size_t m_currentAdditionalEigenvectors</div><div class="ttdef"><b>Definition:</b> pinvit.h:160</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a31e6c16cfe328c08fb74c6cb102168c2"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a31e6c16cfe328c08fb74c6cb102168c2">ug::PINVIT::m_dFreqPrecision</a></div><div class="ttdeci">double m_dFreqPrecision</div><div class="ttdef"><b>Definition:</b> pinvit.h:150</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a3ab558db7969edbdfac83ee86d091c89"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a3ab558db7969edbdfac83ee86d091c89">ug::PINVIT::freq_change</a></div><div class="ttdeci">std::vector&lt; double &gt; freq_change</div><div class="ttdef"><b>Definition:</b> pinvit.h:146</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a3d00f979c3c39acf3b5a8b414fbd24df"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a3d00f979c3c39acf3b5a8b414fbd24df">ug::PINVIT::m_pA</a></div><div class="ttdeci">SmartPtr&lt; ILinearOperator&lt; vector_type &gt; &gt; m_pA</div><div class="ttdef"><b>Definition:</b> pinvit.h:125</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a3d282a8faa1f9098057f343f784fa24c"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a3d282a8faa1f9098057f343f784fa24c">ug::PINVIT::tostring</a></div><div class="ttdeci">std::string tostring()</div><div class="ttdef"><b>Definition:</b> pinvit.h:164</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a3e5399f6cd1bdbbe7273532dd2b6757f"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a3e5399f6cd1bdbbe7273532dd2b6757f">ug::PINVIT::set_abort_on_frequencies_converged_linear_elasticity</a></div><div class="ttdeci">void set_abort_on_frequencies_converged_linear_elasticity(double freq_precision, double density)</div><div class="ttdef"><b>Definition:</b> pinvit.h:230</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a40fa915db8a428519c1dd3b6563f662e"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a40fa915db8a428519c1dd3b6563f662e">ug::PINVIT::set_linear_dependent_eps</a></div><div class="ttdeci">void set_linear_dependent_eps(double eps)</div><div class="ttdef"><b>Definition:</b> pinvit.h:238</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a41e0d6a7931895c7ea09b5bc7e5e3ecd"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a41e0d6a7931895c7ea09b5bc7e5e3ecd">ug::PINVIT::m_pB</a></div><div class="ttdeci">matrix_operator_type * m_pB</div><div class="ttdef"><b>Definition:</b> pinvit.h:128</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a45ca905726a015d40b687cc8bd18fd9a"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a45ca905726a015d40b687cc8bd18fd9a">ug::PINVIT::vector_type</a></div><div class="ttdeci">TAlgebra::vector_type vector_type</div><div class="ttdef"><b>Definition:</b> pinvit.h:110</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a50ae98831dce8d0f07e2a84403dd885b"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a50ae98831dce8d0f07e2a84403dd885b">ug::PINVIT::calculate_correction</a></div><div class="ttdeci">void calculate_correction(vector_type &amp;corr, vector_type &amp;defect)</div><div class="ttdef"><b>Definition:</b> pinvit.h:908</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a5603bf094576f226bd2d747ceca607d6"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a5603bf094576f226bd2d747ceca607d6">ug::PINVIT::m_bPrintEigenvaluesAndDefect</a></div><div class="ttdeci">bool m_bPrintEigenvaluesAndDefect</div><div class="ttdef"><b>Definition:</b> pinvit.h:152</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a58919091e957be3d8073217a3cf60dc9"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a58919091e957be3d8073217a3cf60dc9">ug::PINVIT::m_bStoreDefects</a></div><div class="ttdeci">bool m_bStoreDefects</div><div class="ttdef"><b>Definition:</b> pinvit.h:427</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a5a86451139cb994f3972e4f82ad08552"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a5a86451139cb994f3972e4f82ad08552">ug::PINVIT::apply</a></div><div class="ttdeci">int apply()</div><div class="ttdef"><b>Definition:</b> pinvit.h:459</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a5eab4290dfb288d4edc031036280d227"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a5eab4290dfb288d4edc031036280d227">ug::PINVIT::add_vector</a></div><div class="ttdeci">void add_vector(SmartPtr&lt; vector_type &gt; vec)</div><div class="ttdef"><b>Definition:</b> pinvit.h:246</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a60650ba5bc7f1de117035aa3de4b4605"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a60650ba5bc7f1de117035aa3de4b4605">ug::PINVIT::vbDirichlet</a></div><div class="ttdeci">std::vector&lt; bool &gt; vbDirichlet</div><div class="ttdef"><b>Definition:</b> pinvit.h:140</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a66ad05e8732bab43e3eb90f8fa8124ed"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a66ad05e8732bab43e3eb90f8fa8124ed">ug::PINVIT::m_dDensity_linear_elasticity</a></div><div class="ttdeci">double m_dDensity_linear_elasticity</div><div class="ttdef"><b>Definition:</b> pinvit.h:147</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a66c9acb0d5e2895f37db77b40d209da5"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a66c9acb0d5e2895f37db77b40d209da5">ug::PINVIT::m_linearDependentEps</a></div><div class="ttdeci">double m_linearDependentEps</div><div class="ttdef"><b>Definition:</b> pinvit.h:142</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a671fc034ebd04b9596815d1cc8d016e1"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a671fc034ebd04b9596815d1cc8d016e1">ug::PINVIT::set_store_lambdas</a></div><div class="ttdeci">void set_store_lambdas(bool b)</div><div class="ttdef"><b>Definition:</b> pinvit.h:422</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a6913f1dde8179921c4d0b7bac6d7e4a7"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a6913f1dde8179921c4d0b7bac6d7e4a7">ug::PINVIT::base_type</a></div><div class="ttdeci">DebugWritingObject&lt; TAlgebra &gt; base_type</div><div class="ttdoc">Base type.</div><div class="ttdef"><b>Definition:</b> pinvit.h:115</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a6b3bdd607dfe9e438a3f607883ebe8fb"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a6b3bdd607dfe9e438a3f607883ebe8fb">ug::PINVIT::m_dPrecision</a></div><div class="ttdeci">double m_dPrecision</div><div class="ttdef"><b>Definition:</b> pinvit.h:136</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a6d51438c950df0b23f8dfeb3e8d8c61e"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a6d51438c950df0b23f8dfeb3e8d8c61e">ug::PINVIT::m_iPINVIT</a></div><div class="ttdeci">size_t m_iPINVIT</div><div class="ttdef"><b>Definition:</b> pinvit.h:138</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a70552f3e2c0de67c35911a410c66e6fb"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a70552f3e2c0de67c35911a410c66e6fb">ug::PINVIT::m_bUseAdditionalCorrections</a></div><div class="ttdeci">bool m_bUseAdditionalCorrections</div><div class="ttdef"><b>Definition:</b> pinvit.h:157</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a7432e063685e7e51672025a53e012105"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a7432e063685e7e51672025a53e012105">ug::PINVIT::m_additionalEigenvectorsToKeep</a></div><div class="ttdeci">size_t m_additionalEigenvectorsToKeep</div><div class="ttdef"><b>Definition:</b> pinvit.h:159</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a7af526c8b8827f08e182acd87ec203c0"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a7af526c8b8827f08e182acd87ec203c0">ug::PINVIT::matrix_operator_type</a></div><div class="ttdeci">IPreconditioner&lt; TAlgebra &gt;::matrix_operator_type matrix_operator_type</div><div class="ttdef"><b>Definition:</b> pinvit.h:127</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a7f43af63812849e8a78015b43d0ddb53"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a7f43af63812849e8a78015b43d0ddb53">ug::PINVIT::lambda</a></div><div class="ttdeci">std::vector&lt; double &gt; lambda</div><div class="ttdef"><b>Definition:</b> pinvit.h:139</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a8adfcf43fe55d8b7a5a404d05c6aae04"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a8adfcf43fe55d8b7a5a404d05c6aae04">ug::PINVIT::m_bLaplacian</a></div><div class="ttdeci">bool m_bLaplacian</div><div class="ttdef"><b>Definition:</b> pinvit.h:144</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a8c82e4d68d68248e586a11d8ba8b863c"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a8c82e4d68d68248e586a11d8ba8b863c">ug::PINVIT::matrix_type</a></div><div class="ttdeci">TAlgebra::matrix_type matrix_type</div><div class="ttdef"><b>Definition:</b> pinvit.h:111</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a962def0ddf4c23d71ee7582d8521de39"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a962def0ddf4c23d71ee7582d8521de39">ug::PINVIT::set_preconditioner</a></div><div class="ttdeci">void set_preconditioner(SmartPtr&lt; ILinearIterator&lt; vector_type &gt; &gt; precond)</div><div class="ttdef"><b>Definition:</b> pinvit.h:256</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_a9e8e493125d3054cd5e6c27abe945e57"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#a9e8e493125d3054cd5e6c27abe945e57">ug::PINVIT::m_bStoreLambdas</a></div><div class="ttdeci">bool m_bStoreLambdas</div><div class="ttdef"><b>Definition:</b> pinvit.h:428</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_aa77dadc26f6be3f2beee8078c18415e3"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#aa77dadc26f6be3f2beee8078c18415e3">ug::PINVIT::m_maxIterations</a></div><div class="ttdeci">size_t m_maxIterations</div><div class="ttdef"><b>Definition:</b> pinvit.h:135</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_aa8abe54c08e78fa77b2d07f55859fe60"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#aa8abe54c08e78fa77b2d07f55859fe60">ug::PINVIT::m_bPrintUsedTestvectors</a></div><div class="ttdeci">bool m_bPrintUsedTestvectors</div><div class="ttdef"><b>Definition:</b> pinvit.h:156</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_ab2da2a31c40c7cb6ee1f2aea85f3a92b"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#ab2da2a31c40c7cb6ee1f2aea85f3a92b">ug::PINVIT::vector_value_type</a></div><div class="ttdeci">vector_type::value_type vector_value_type</div><div class="ttdef"><b>Definition:</b> pinvit.h:112</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_ab3af1cf6e271a41548f019aaa82adcf2"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#ab3af1cf6e271a41548f019aaa82adcf2">ug::PINVIT::config_string</a></div><div class="ttdeci">virtual std::string config_string() const</div><div class="ttdef"><b>Definition:</b> pinvit.h:168</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_ab43c1be96a7545cb39d4ac9a6ffed6cc"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#ab43c1be96a7545cb39d4ac9a6ffed6cc">ug::PINVIT::m_bPrintProjectedEigenproblem</a></div><div class="ttdeci">bool m_bPrintProjectedEigenproblem</div><div class="ttdef"><b>Definition:</b> pinvit.h:155</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_abcaa30a9e4ac7d04265bbf9feeae6651"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#abcaa30a9e4ac7d04265bbf9feeae6651">ug::PINVIT::set_precision</a></div><div class="ttdeci">void set_precision(double precision)</div><div class="ttdef"><b>Definition:</b> pinvit.h:311</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_abf2ba53fe4d2cbd0ca45e1700a47310c"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#abf2ba53fe4d2cbd0ca45e1700a47310c">ug::PINVIT::debug_calc_projected_eigenvalues</a></div><div class="ttdeci">void debug_calc_projected_eigenvalues(DenseMatrix&lt; VariableArray2&lt; double &gt; &gt; &amp;r_ev, SmartPtrVector&lt; vector_type &gt; &amp;pTestVectors, int iteration, bool bWrite)</div><div class="ttdef"><b>Definition:</b> pinvit.h:693</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_ac051bb396f2708713a529058d8a15c1f"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#ac051bb396f2708713a529058d8a15c1f">ug::PINVIT::set_pinvit</a></div><div class="ttdeci">void set_pinvit(size_t iPINVIT)</div><div class="ttdef"><b>Definition:</b> pinvit.h:340</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_ac35647bdd92c618c3ae58d30a0ca0382"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#ac35647bdd92c618c3ae58d30a0ca0382">ug::PINVIT::assert_real_positive</a></div><div class="ttdeci">void assert_real_positive(const std::vector&lt; std::complex&lt; double &gt; &gt; &amp;r_lambda)</div><div class="ttdef"><b>Definition:</b> pinvit.h:818</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_ac3e8733b87612508126bcdaa64909618"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#ac3e8733b87612508126bcdaa64909618">ug::PINVIT::m_bPrintProjectedEigenvalues</a></div><div class="ttdeci">bool m_bPrintProjectedEigenvalues</div><div class="ttdef"><b>Definition:</b> pinvit.h:153</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_ad05e29b7884a2d12d5e7476e189b5764"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#ad05e29b7884a2d12d5e7476e189b5764">ug::PINVIT::set_max_iterations</a></div><div class="ttdeci">void set_max_iterations(size_t maxIterations)</div><div class="ttdef"><b>Definition:</b> pinvit.h:306</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_ad1ac607fa3463a6446bfcb663d6a5916"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#ad1ac607fa3463a6446bfcb663d6a5916">ug::PINVIT::get_projected_eigenvalue_problem</a></div><div class="ttdeci">void get_projected_eigenvalue_problem(DenseMatrix&lt; VariableArray2&lt; double &gt; &gt; &amp;rA, DenseMatrix&lt; VariableArray2&lt; double &gt; &gt; &amp;rB, SmartPtrVector&lt; vector_type &gt; &amp;pTestVectors, std::vector&lt; std::string &gt; &amp;vTestVectorDescription)</div><div class="ttdef"><b>Definition:</b> pinvit.h:1176</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_ad56f3f49b7cf362cb267f8a3154f32cb"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#ad56f3f49b7cf362cb267f8a3154f32cb">ug::PINVIT::set_additional_eigenvectors_to_keep</a></div><div class="ttdeci">void set_additional_eigenvectors_to_keep(size_t i)</div><div class="ttdef"><b>Definition:</b> pinvit.h:318</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_ad5d86f432b8aaa5d70296a5b7fd9e908"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#ad5d86f432b8aaa5d70296a5b7fd9e908">ug::PINVIT::set_linear_operator_A</a></div><div class="ttdeci">void set_linear_operator_A(SmartPtr&lt; ILinearOperator&lt; vector_type &gt; &gt; loA)</div><div class="ttdef"><b>Definition:</b> pinvit.h:261</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_ad947a96e0f668b16dc2b6dd7c7637e96"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#ad947a96e0f668b16dc2b6dd7c7637e96">ug::PINVIT::px</a></div><div class="ttdeci">SmartPtrVector&lt; vector_type &gt; px</div><div class="ttdef"><b>Definition:</b> pinvit.h:132</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_ad982a5671eb0303e64e0575b20e99a7f"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#ad982a5671eb0303e64e0575b20e99a7f">ug::PINVIT::m_bPrintProjectedEigenvectors</a></div><div class="ttdeci">bool m_bPrintProjectedEigenvectors</div><div class="ttdef"><b>Definition:</b> pinvit.h:154</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_ad9e6ad3ee0fc5f7bc40af2b72f35d409"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#ad9e6ad3ee0fc5f7bc40af2b72f35d409">ug::PINVIT::m_bAbortOnFreqConverged_linear_elasticity</a></div><div class="ttdeci">bool m_bAbortOnFreqConverged_linear_elasticity</div><div class="ttdef"><b>Definition:</b> pinvit.h:149</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_adf61a0760e11a5f4f1d18aa55d232e21"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#adf61a0760e11a5f4f1d18aa55d232e21">ug::PINVIT::algebra_type</a></div><div class="ttdeci">TAlgebra algebra_type</div><div class="ttdef"><b>Definition:</b> pinvit.h:107</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_ae3e6f3286a16abaf4cd3c9c658c9d4ec"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#ae3e6f3286a16abaf4cd3c9c658c9d4ec">ug::PINVIT::PINVIT</a></div><div class="ttdeci">PINVIT()</div><div class="ttdef"><b>Definition:</b> pinvit.h:200</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_aed70c2b88ad60909a50e33c19d39b30d"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#aed70c2b88ad60909a50e33c19d39b30d">ug::PINVIT::compute_rayleigh_and_defect</a></div><div class="ttdeci">void compute_rayleigh_and_defect(vector_type &amp;x, double &amp;lambda, vector_type &amp;defect, double &amp;defectNorm)</div><div class="ttdef"><b>Definition:</b> pinvit.h:941</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_af016687f336e2bfec313c6f3f13037d6"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#af016687f336e2bfec313c6f3f13037d6">ug::PINVIT::m_bDebugCalcProjectedEigenvalues</a></div><div class="ttdeci">bool m_bDebugCalcProjectedEigenvalues</div><div class="ttdef"><b>Definition:</b> pinvit.h:158</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_af24635ed0789813f7eb2df2377600144"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#af24635ed0789813f7eb2df2377600144">ug::PINVIT::m_dMinimumDefectToCalcCorrection</a></div><div class="ttdeci">double m_dMinimumDefectToCalcCorrection</div><div class="ttdef"><b>Definition:</b> pinvit.h:130</div></div>
<div class="ttc" id="aclassug_1_1_p_i_n_v_i_t_html_af348a5ffeb9a215ba119a36d4e6de4ce"><div class="ttname"><a href="classug_1_1_p_i_n_v_i_t.html#af348a5ffeb9a215ba119a36d4e6de4ce">ug::PINVIT::get_testvectors</a></div><div class="ttdeci">void get_testvectors(int iteration, SmartPtrVector&lt; vector_type &gt; &amp;vCorr, std::vector&lt; std::string &gt; &amp;vCorrectionName, size_t numCorrections, SmartPtrVector&lt; vector_type &gt; &amp;vOldX, SmartPtrVector&lt; vector_type &gt; &amp;vAdditional, SmartPtrVector&lt; vector_type &gt; &amp;pTestVectors, std::vector&lt; std::string &gt; &amp;vTestVectorDescription, std::vector&lt; bool &gt; &amp;bConverged)</div><div class="ttdef"><b>Definition:</b> pinvit.h:1034</div></div>
<div class="ttc" id="aclassug_1_1_smart_ptr_vector_html"><div class="ttname"><a href="classug_1_1_smart_ptr_vector.html">ug::SmartPtrVector&lt; vector_type &gt;</a></div></div>
<div class="ttc" id="aconv__rates__kinetic_8lua_html_a67171a8de2a01179202fc9eb332a6444"><div class="ttname"><a href="conv__rates__kinetic_8lua.html#a67171a8de2a01179202fc9eb332a6444">compute</a></div><div class="ttdeci">function util rates kinetic compute(ConvRateSetup)</div></div>
<div class="ttc" id="adebug__writer_8h_html"><div class="ttname"><a href="debug__writer_8h.html">debug_writer.h</a></div></div>
<div class="ttc" id="aeigenvalue2_8h_html"><div class="ttname"><a href="eigenvalue2_8h.html">eigenvalue2.h</a></div></div>
<div class="ttc" id="agroup__small__strain__mechanics_html_gaf07906d860d20ad045f1718f42778749"><div class="ttname"><a href="../plugins/group__small__strain__mechanics.html#gaf07906d860d20ad045f1718f42778749">init</a></div><div class="ttdeci">virtual void init()</div></div>
<div class="ttc" id="agroup__ugbase__common__util_html_gaaf72bcd4f74729e4a43694267e8590d8"><div class="ttname"><a href="group__ugbase__common__util.html#gaaf72bcd4f74729e4a43694267e8590d8">SPNULL</a></div><div class="ttdeci">const NullSmartPtr SPNULL</div><div class="ttdoc">The equivalent to NULL for smart pointers.</div><div class="ttdef"><b>Definition:</b> smart_pointer.h:90</div></div>
<div class="ttc" id="agroup__ugbase__common_html_ga0b928ef153b78f1b5e025638cf28f841"><div class="ttname"><a href="group__ugbase__common.html#ga0b928ef153b78f1b5e025638cf28f841">UG_ASSERT</a></div><div class="ttdeci">#define UG_ASSERT(expr, msg)</div><div class="ttdef"><b>Definition:</b> assert.h:70</div></div>
<div class="ttc" id="alib__algebra_2algebra__common_2vector__util_8h_html"><div class="ttname"><a href="lib__algebra_2algebra__common_2vector__util_8h.html">vector_util.h</a></div></div>
<div class="ttc" id="alinear__operator_8h_html"><div class="ttname"><a href="linear__operator_8h.html">linear_operator.h</a></div></div>
<div class="ttc" id="amatrix__operator_8h_html"><div class="ttname"><a href="matrix__operator_8h.html">matrix_operator.h</a></div></div>
<div class="ttc" id="anamespaceug_html"><div class="ttname"><a href="namespaceug.html">ug</a></div><div class="ttdoc">the ug namespace</div></div>
<div class="ttc" id="anamespaceug_html_a085c53799397d7f152f03ade000d2baa"><div class="ttname"><a href="namespaceug.html#a085c53799397d7f152f03ade000d2baa">ug::ConfigShift</a></div><div class="ttdeci">string ConfigShift(string s)</div><div class="ttdef"><b>Definition:</b> string_util.cpp:457</div></div>
<div class="ttc" id="apreconditioner_8h_html"><div class="ttname"><a href="preconditioner_8h.html">preconditioner.h</a></div></div>
<div class="ttc" id="aprogress_8h_html"><div class="ttname"><a href="progress_8h.html">progress.h</a></div></div>
<div class="ttc" id="asmall__algebra_2additional__math_8h_html"><div class="ttname"><a href="small__algebra_2additional__math_8h.html">additional_math.h</a></div></div>
<div class="ttc" id="asmart__ptr__vector_8h_html"><div class="ttname"><a href="smart__ptr__vector_8h.html">smart_ptr_vector.h</a></div></div>
<div class="ttc" id="asort__util_8h_html"><div class="ttname"><a href="sort__util_8h.html">sort_util.h</a></div></div>
<div class="ttc" id="asparsematrix__interface_8h_html_a265a253612b46abed17c61b0a5e5ce30"><div class="ttname"><a href="sparsematrix__interface_8h.html#a265a253612b46abed17c61b0a5e5ce30">value_type</a></div><div class="ttdeci">T value_type</div><div class="ttdef"><b>Definition:</b> sparsematrix_interface.h:2</div></div>
<div class="ttc" id="astring__util_8h_html"><div class="ttname"><a href="string__util_8h.html">string_util.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_80abd05104fe5ed4636c8ba64911e654.html">ugbase</a></li><li class="navelem"><a class="el" href="dir_2e5eee3e6a2607df2611cb3dc665a6d5.html">lib_algebra</a></li><li class="navelem"><a class="el" href="dir_3ec088f778c44889f52dc602c90557d0.html">operator</a></li><li class="navelem"><a class="el" href="dir_f4535e34f8cbb9d7089a37a52fe9f1c4.html">eigensolver</a></li><li class="navelem"><a class="el" href="pinvit_8h.html">pinvit.h</a></li>
    <li class="footer">Generated on Mon Sep 18 2023 00:53:00 for ug4 by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
