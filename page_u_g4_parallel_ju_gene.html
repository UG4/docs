<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ug4: JuGene</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ug4
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('page_u_g4_parallel_ju_gene.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">JuGene </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section attention"><dt>Attention</dt><dd>Please note that the BG/P system <em>JuGene</em> was replaced by the BG/Q system named <em>JuQueen</em> in July 2012, see page <a class="el" href="page_u_g4_parallel_ju_queen.html">JuQueen</a> for some instructions to work on this successor of <em>JuGene!</em> Although with this replacement not only the hardware has changed the following informations on <em>JuGene</em> might remain of some use (especially some links to out-sourced parts of the documentation) and is left here to the careful reader. In addition maybe sometime a <b>ug4</b> user will have access to another BG/P machine.</dd></dl>
<ul>
<li><a class="el" href="page_u_g4_parallel_ju_gene.html#secJuGene">General Information about JuGene</a></li>
<li><a class="el" href="page_u_g4_parallel_ju_gene.html#secAccess_to_JuGenes_login_nodes">Access to JuGene's Login Nodes</a></li>
<li><a class="el" href="page_u_g4_parallel_ju_gene.html#secConfiguration_of_ug4_for_JuGene">Configuration of ug4 for JuGene</a></li>
<li><a class="el" href="page_u_g4_parallel_ju_gene.html#secWorking_with_ug4_on_JuGene">Working with ug4 on JuGene</a></li>
<li><a class="el" href="page_u_g4_parallel_ju_gene.html#secVery_large_jobs_on_JuGene">Very large Jobs on JuGene</a></li>
<li><a class="el" href="page_u_g4_parallel_ju_gene.html#secDebuggingOnJuGene">Debugging on JuGene</a></li>
</ul>
<hr  />
 <h1><a class="anchor" id="secJuGene"></a>
General Information about JuGene</h1>
<p><a href="http://www.fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JUGENE/JUGENE_node.html">JuGene</a> &mdash; the <a href="http://www.fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JUGENE/Configuration/Configuration_node.html">72 racks Blue Gene/P</a> (BG/P) system at <em>J&uuml;lich Supercomputing Centre (JSC)</em> (FZ J&uuml;lich) in total provides 294.912 cores (288 Ki) and 144 Tbyte RAM. The 73.728 compute nodes (CN) each have a quadcore Power 32-bit PC 450 running at 850 MHz, with 2 Gbyte of RAM.</p>
<p>Half a rack (2048 cores) is called a <b>midplane</b>. The <em>JuGene</em> system uses five different networks dedicated for various tasks and functionalities of the machine. Relevant for us: The 3-D torus network. This is a point-to-point network &mdash; each of the CNs has six nearest-neighbour connections.</p>
<p>See more on the architecture of <em>JuGene</em> <a href="http://www.fz-juelich.de/SharedDocs/Downloads/IAS/JSC/EN/JUGENE/SlidesBGPArchitecture.pdf">here</a>.</p>
<p>More information about <em>JuGene</em> "in order to enable users of the system to 
achieve good performance of their applications" can be found in <a href="http://www.prace-ri.eu/IMG/pdf/Best-practise-guide-JUGENE-v0-3.pdf">"PRACE Best-Practice Guide for JUGENE"</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Note that the login nodes are running under <em>SuSE Linux Enterprise Server 10</em> (SLES 10), while the CNs are running a limited version of Linux called <em>Compute Node Kernel</em> (CNK). Therefore its necessary to <b>cross-compile</b> for <em>JuGene</em> (cf. sec. <a class="el" href="page_u_g4_setup_parallel.html#secCMake">CMake, Toolchains, Compilers</a>; sec. <a class="el" href="page_u_g4_parallel_ju_gene.html#secConfiguration_of_ug4_for_JuGene">Configuration of ug4 for JuGene</a>).</dd></dl>
<hr  />
 <h1><a class="anchor" id="secAccess_to_JuGenes_login_nodes"></a>
Access to JuGene's Login Nodes</h1>
<p><em>JuGene</em> is reached via two so called <b>front-end</b> or <b>login nodes</b> (<code>jugene3</code> and <code>jugene4</code>) for interactive access and the submission of batch jobs.</p>
<p>These login nodes are reached via </p><div class="fragment"><div class="line">ssh &lt;user&gt;@jugene.fz-juelich.de</div>
</div><!-- fragment --><p> i.e., for login there is only a generic hostname, <code>jugene.fz-juelich.de</code>, from which automatically a connection either to <code>jugene3</code> or <code>jugene4</code> will be established.</p>
<p>The front-end nodes have an identical environment, but multiple sessions of one user may reside on different nodes which must be taken into account when killing processes.</p>
<p>It is necessary to <b>upload the SSH key</b> of the machine from which to connect to one of JuGenes login nodes. See <a href="http://www.fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JUGENE/UserInfo/Logon.html">Logging on to JUGENE</a> (also for <em>X11</em> problems).</p>
<p>To be able to connect to <em>JuGene</em> from different machines maybe you find it useful to define one of <em>GCSC's</em> machines (e.g. <code>speedo</code>, <code>quadruped</code>, ...) as a "springboard" to one of <em>JuGenes</em> login nodes (so that you have to login to this machine first, then to <em>JuGene</em>), see <a class="el" href="page_u_g4_s_s_h.html#secSSHHopping">SSH Hopping</a>.</p>
<hr  />
 <h1><a class="anchor" id="secConfiguration_of_ug4_for_JuGene"></a>
Configuration of ug4 for JuGene</h1>
<p>For <em>JuGene</em> you have to "cross compile" and to do so use a specific <a class="el" href="page_u_g4_setup_parallel.html#secCMake_ToolchainFiles">Toolchain File</a>. Start CMake like this </p><div class="fragment"><div class="line"><a class="code" href="unit__tests_8doxygen.html#af700cfda4d235180bc73979f77d01cca">cmake</a> -DCMAKE_TOOLCHAIN_FILE=../<a class="code" href="unit__tests_8doxygen.html#af700cfda4d235180bc73979f77d01cca">cmake</a>/toolchain/jugene.cmake ..</div>
<div class="ttc" id="aunit__tests_8doxygen_html_af700cfda4d235180bc73979f77d01cca"><div class="ttname"><a href="unit__tests_8doxygen.html#af700cfda4d235180bc73979f77d01cca">cmake</a></div><div class="ttdeci">cmake</div><div class="ttdef"><b>Definition:</b> unit_tests.doxygen:198</div></div>
</div><!-- fragment --><p> or, for <b>static builds</b> which is the <b>configuration of choice</b> if you want to <b>process very large jobs</b>, </p><div class="fragment"><div class="line"><a class="code" href="unit__tests_8doxygen.html#af700cfda4d235180bc73979f77d01cca">cmake</a> -DSTATIC=ON -DCMAKE_TOOLCHAIN_FILE=../<a class="code" href="unit__tests_8doxygen.html#af700cfda4d235180bc73979f77d01cca">cmake</a>/toolchain/jugene_static.cmake ..</div>
</div><!-- fragment --><p>See also <a class="el" href="page_u_g4_parallel_ju_gene.html#secVery_large_jobs_on_JuGene">Very large Jobs on JuGene</a>!</p>
<dl class="section note"><dt>Note</dt><dd>A <em>static build</em> where also all system libraries are linked statically need some additional "hand work" by now: After configuration with <em>CMake</em> edit the following files by replacing all occurences of <code>libXXXXXXX.so</code> by <code>libXXXXXXX.a</code> (has to be done only once): <div class="fragment"><div class="line">CMakeCache.txt,</div>
<div class="line">ugbase/ug_shell/CMakeFiles/ugshell.dir/link.txt,</div>
<div class="line">ugbase/ug_shell/CMakeFiles/ugshell.dir/build.make</div>
</div><!-- fragment --></dd></dl>
<p>Or use this <code>sed</code> command: </p><div class="fragment"><div class="line">sed -i <span class="stringliteral">&#39;s/\&zwj;([[:alnum:]]*\&zwj;).so/\1.a/g&#39;</span> CMakeCache.txt ugbase/ug_shell/CMakeFiles/ugshell.dir/link.txt ugbase/ug_shell/CMakeFiles/ugshell.dir/build.make </div>
</div><!-- fragment --><p>You can check your executable by running the (standard unix) <code>ldd</code> command ("list dynamic dependencies") on it: </p><div class="fragment"><div class="line">ldd ugshell</div>
</div><!-- fragment --><p> Answer should be <code>not a dynamic executable</code> for a completely static build!</p>
<p><b>Debug builds</b>: Since the pre-installed <em>GCC 4.1.2</em> (in April 2012) is not able to compile a "debug" build one should add the flag <code>-DDEBUG_FORMAT=-gstabs</code> to the CMake call (cf. <a class="el" href="page_troubleshooting.html#secCMake_GCC412">GCC 4.1.2</a>).</p>
<p>For debugging a parallel application on JuGene see <a class="el" href="page_u_g4_parallel_ju_gene.html#secDebuggingOnJuGene">Debugging on JuGene</a></p>
<hr  />
 <h1><a class="anchor" id="secWorking_with_ug4_on_JuGene"></a>
Working with ug4 on JuGene</h1>
<h2><a class="anchor" id="secBasic_job_handling"></a>
Basic Job Handling</h2>
<p>Please take the time and fill out the details in <code>ugsubmit</code> / <code>uginfo</code> / <code>ugcancel</code> (<a class="el" href="pageugsubmit.html">ugsubmit - Job Scheduling on Clusters</a>).</p>
<p>See <a href="http://www.fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JUGENE/UserInfo/QuickIntroduction.html">Quick Introduction</a> to job handling. Also look at <a href="http://www.fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JUGENE/UserInfo/mpirun.html">job/mpirun options</a>.</p>
<p>Here we only introduce some important details (everything else should become clear by examining the examples provided): </p><ul>
<li>
<b>Jobs can be submitted</b> by the <code>llrun</code> (interactively) and the <code>mpirun</code> (as batch job; defined in a <em>LoadLeveler</em> script) command. See below for some details.  </li>
<li>
<p class="startli">There are different <b>execution modes</b> which can be specified by the <code>mpirun</code> and <code>llrun</code> parameter <code>-mode {VN | DUAL | SMP}</code>: </p><ul>
<li>
<b>Quad Mode</b> (a.k.a. "Virtual Mode"): All four cores run one MPI process. Memory/MPI Process = 1/4 CN RAM: <code>-mode VN</code>.  </li>
<li>
<b>Dual Mode</b>: Two cores run one MPI process (hybrid MPI/OpenMP). Memory/MPI Process = 1/2 CN RAM: <code>-mode DUAL</code>.  </li>
<li>
<b>SMP Mode</b> ("Symmetrical Multi Processing Mode"): All four cores run one MPI process (hybrid MPI/OpenMP). Memory/MPI Process = CN RAM: <code>-mode SMP</code>.  </li>
</ul>
<p>Note that in quad mode (using all 4 processors of a computing node) this means each core has only ca. 512 Mbyte of RAM (474 Mbyte to be more specific, since the CNK also needs some memory).</p>
<p class="endli">Obviously "VN" is the preferred execution mode if large numbers of processes should be achieved &mdash; and <b>ug4</b> works with VN mode (at least up to ~64 Ki DoFs per process)!  </p>
</li>
<li>
<p class="startli">The <code>mpirun</code> parameter <code>-mapfile</code> specifies an order in which the MPI processes are mapped to the CNs / the cores of the BG/P partition reserved for the run. This order can either be specified by a permutation of the letters X,Y,Z and T <em>or</em> the name of a mapfile in which the distribution of the tasks is specified, <code>-mapfile {&lt;mapping&gt;|&lt;mapfile&gt;}</code>: </p><ul>
<li>
<p class="startli"><code>&lt;mapping&gt;</code> is a permutation of X, Y, Z and T.</p>
<p class="interli">The standard mapping on <em>JuGene</em> is to place the tasks in "XYZT" order, where X, Y, and Z are the torus coordinates of the nodes in the partition and T is the number of the cores within each node (T=0,1,2,3).</p>
<p class="endli">When the tasks are distributed across the nodes the first dimension is increased first, i.e. for XYZT the first three tasks would be executed by the nodes with the torus coordinates <code>&lt;0,0,0,0&gt;</code>, <code>&lt;1,0,0,0&gt;</code> and <code>&lt;2,0,0,0&gt;</code>, which obviously is not what we want for our simulation runs. For now we recommend <code>-mapfile TXYZ</code> which fills up a CN before going to the next CN so that MPI processes working on adjacent subdomains are placed closely in the 3-D torus.  </p>
</li>
<li>
<code>&lt;mapfile&gt;</code> is the name of a mapfile in which the distribution of the tasks is specified: It contains a line of <code>x y z t</code> coordinates for each MPI process. See sec. 6. of the <em>Best-Practise guide</em> mentioned above for an example and which LoadLeveler keywords to use.  </li>
</ul>
<p class="endli"></p>
</li>
<li>
If <b>ug4</b> was dynamically linked add to the <code>mpirun</code> parameters <code>-env LD_LIBRARY_PATH==/bgsys/drivers/ppcfloor/comm/lib/</code>. <dl class="section note"><dt>Note</dt><dd>This parameter is (obviously) not necessary for completely static builds!</dd></dl>
</li>
<li>
<p class="startli"><b>"Modules"</b> can be loaded by executing the <code>module</code> command.</p>
<p class="interli">E.g. <code>module load lapack</code> for LAPACK (see <a href="http://www.fz-juelich.de/ias/jsc/EN/Expertise/Support/Software/Libraries/LAPACKJugene.html">http://www.fz-juelich.de/ias/jsc/EN/Expertise/Support/Software/Libraries/LAPACKJugene.html</a> for choosing one of several versions).</p>
<pre class="fragment">This is also for loading &lt;strong&gt;performance analysis tools&lt;/strong&gt;, e.g. 
&lt;tt&gt;module load scalasca&lt;/tt&gt;, &lt;tt&gt;module load UNITE&lt;/tt&gt; etc.
</pre><p> <br  />
</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><a href="http://www.fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JUGENE/UserInfo/llview.html"><code>llview</code></a> is a <b>tool with a graphical X11 user interface</b> for displaying system status, running jobs, scheduling and prediction of the start time of jobs (the latter can also be achieved by the <code>llq</code> command, see below).</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Interactive jobs</b> can be started with the <a href="http://www.fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JUGENE/UserInfo/LoadLevelerInteractive.html">llrun</a> command. <code>llrun</code> is invoked in the following way: </p><div class="fragment"><div class="line">llrun [&lt;llrun_options&gt;] [&lt;mpirun_options&gt;] [&lt;executable&gt;]</div>
</div><!-- fragment --><p> <code>llrun</code> replaces <code>mpirun</code> and can be used with the same command line options like <code>mpirun</code>. One <code>llrun</code> option which might be interesting: <code> -w &lt;hh:mm:ss&gt;</code>: submit job with wallclock limit (Default: 00:30:00). For other options see e.g. <a href="http://www.prace-ri.eu/IMG/pdf/Best-practise-guide-JUGENE-v0-3.pdf">http://www.prace-ri.eu/IMG/pdf/Best-practise-guide-JUGENE-v0-3.pdf</a>, sec. 3.5.3.</p>
<p class="interli"><b>Example</b>: </p><div class="fragment"><div class="line">llrun -np 4 -mode VN -mapfile TXYZ -<a class="code" href="checkpoint__util_8lua.html#a7e587ebfa42129125fe2e79410a09ef8">verbose</a> 2 -exe ./ugshell_debug -args <span class="stringliteral">&quot;-ex ../apps/scaling_tests/modular_scalability_test.lua -numPreRefs 3 -numRefs  7&quot;</span></div>
<div class="ttc" id="acheckpoint__util_8lua_html_a7e587ebfa42129125fe2e79410a09ef8"><div class="ttname"><a href="checkpoint__util_8lua.html#a7e587ebfa42129125fe2e79410a09ef8">verbose</a></div><div class="ttdeci">location verbose</div><div class="ttdef"><b>Definition:</b> checkpoint_util.lua:128</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Note the quotation marks around the executables arguments!</dd></dl>
<pre class="fragment">Please note that &lt;tt&gt;llrun&lt;/tt&gt; only allows jobs up to 256 
(&lt;tt&gt;-mode SMP&lt;/tt&gt;) / 512 (&lt;tt&gt;-mode DUAL&lt;/tt&gt;) / 1024 (&lt;tt&gt;-mode VN&lt;/tt&gt;) 
MPI processes!
</pre>  </li>
<li>
<p class="startli"><b>Batch Jobs</b> are defined in so called <b>"LoadLeveler 
    scripts"</b> and submitted by the <a href="http://www2.fz-juelich.de/jsc/jugene/usage/loadl/llsubmit/"><code>llsubmit</code></a> command to the <em>IBM Tivoli Workload Scheduler LoadLeveler</em> (TWS LoadLeveler), typically in the directory where the ug4 executable resides: </p><div class="fragment"><div class="line">llsubmit &lt;cmdfile&gt;</div>
</div><!-- fragment --><p> <code>&lt;cmdfile&gt;</code> is a (plain Unix) shell script file (i.e., the "LoadLeveler script"), which contains job definitions given by <b>"LoadLeveler keywords"</b> (some important examples are explained below).</p>
<p class="interli">If <code>llsubmit</code> was able to submit the job it outputs a <b>job name</b> (e.g. <code>jugene4b.zam.kfa-juelich.de.298508</code>) with which a specific job can be identified in further commands, e.g. to cancel it (see below).</p>
<p class="interli">The <b>output</b> of the run (messages from Frontend end Backend MPI &mdash; and the output of <b>ug4</b> &mdash; is written to a file in the directory where <code>llsubmit</code> was executed and whose name begins with the job name you have specified in the LoadLeveler script and ends with <code>&lt;job number&gt;.out</code>.</p>
<p class="interli">For some <b>example LoadLeveler scripts</b> used with <b>ug4</b> see subdirectory <code>scripts/shell/</code>:</p>
<ul>
<li>
<code>ll_scale_gmg.x</code> contains job definitions for a complete scalability study for GMG in 2-D and 3-D.  </li>
<li>
<code>ll_template.x</code> also contains some documentation of LoadLeveler and mpirun parameters.  </li>
</ul>
<p>(All <code>mpirun</code> commands therein are commented out &mdash; to performe a specific run remove the comment sign.)</p>
<p class="interli">Please change in your copy of one of these scripts at least the value of the <code>notify_user</code> keyword before submitting a job ...</p>
<p class="endli">See also this <a href="http://www.fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JUGENE/UserInfo/LoadLeveler.html">more recent JSC documentation</a>, and especially the <a href="http://www.fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JUGENE/UserInfo/LoadLevelerSamples.html">Job File Samples</a> for more details.  </p>
</li>
<li>
<p class="startli"><b>LoadLeveler keywords</b> are strings embedded in comments beginning with the characters "# @".</p>
<p class="interli">Some selected keywords: </p><ul>
<li>
<code>job_type = bluegene</code> specifies that the job is running on <em>JuGene</em>'s CNs.  </li>
<li>
<code>job_name</code> specifies the name of the job, which will get part of the name of the output file.  </li>
<li>
<p class="startli"><code>bg_size</code> specifies the size of the BG/P partition reserved for the job in <b>number of compute nodes</b>.</p>
<p class="interli">That is, for <code>&lt;NP&gt;</code> MPI processes, <code>bg_size</code> must be &gt;= <code>(&lt;NP&gt;)/4</code>.</p>
<p class="interli">Alternatively the size of a job can be defined by the <code>bg_shape</code> keyword.</p>
<p class="endli">See comments in the example LoadLeveler scripts for proper settings.  </p>
</li>
<li>
<p class="startli"><code>bg_connection</code> specifies the "connection type", i.e. the <b>network topology</b> used by a job.</p>
<p class="interli">Connection type can be one in <code>[TORUS| MESH | PREFER_TORUS]</code>. Default is <code>bg_connection = MESH</code>.</p>
<p class="interli"><code>bg_connection = TORUS</code> &mdash; utilising the 3-D torus network &mdash; is the preferred topology for our jobs. For this <code>bg_size</code> (see above) must be &gt;= 512.</p>
<p class="endli">See also comments and usage in the example LoadLeveler scripts for proper settings.  </p>
</li>
</ul>
<p>Please note that keywords must not be followed by comments in the same line!</p>
<p class="endli">A nice introduction to LoadLeveler command file syntax is given e.g. <a href="https://docs.loni.org/wiki/LoadLeveler_Command_File_Syntax">here</a>.  </p>
</li>
<li>
<p class="startli"><code>llq</code> is used to display the status of jobs (of a specified user) in the queue/executed: </p><div class="fragment"><div class="line">llq [-u  &lt;userid&gt;]</div>
</div><!-- fragment --><p class="interli">The <b>estimated start time</b> of a job can be determined by <code>llq -s &lt;job-id&gt;</code> (cf. <a href="https://docs.loni.org/wiki/Useful_LoadLeveler_Commands">https://docs.loni.org/wiki/Useful_LoadLeveler_Commands</a>), where <code>&lt;job-id&gt;</code> was determined by the previous command, e.g. for the job <code>jugene4b.304384.0</code>:</p>
<div class="fragment"><div class="line">llq -<a class="codeRef" href="../plugins/_biogas_8lua.html#a9dda901d5ee6289370201a700f88e789">s</a> 304384  </div>
<div class="line"> </div>
<div class="line">===== EVALUATIONS FOR JOB STEP jugene4b.zam.kfa-juelich.de.304384.0 =====</div>
<div class="line"> </div>
<div class="line">Step state                       : Idle</div>
<div class="line">Considered <span class="keywordflow">for</span> scheduling at     : Sun 01 Apr 2012 00:02:55 CEST</div>
<div class="line">Top dog estimated start time     : Sun 01 Apr 2012 16:38:55 CEST</div>
<div class="line">...</div>
<div class="ttc" id="a_biogas_8lua_html_a9dda901d5ee6289370201a700f88e789"><div class="ttname"><a href="../plugins/_biogas_8lua.html#a9dda901d5ee6289370201a700f88e789">s</a></div><div class="ttdeci">parameterString s</div></div>
</div><!-- fragment --><p class="endli"></p>
</li>
<li>
<code>llcancel</code> is used to cancel a job (<code>&lt;jobname&gt;</code> as displayed by <code>llq</code>): <div class="fragment"><div class="line">llcancel &lt;jobname&gt;</div>
</div><!-- fragment -->  </li>
<li>
Debugging: See documentation to the tools <code>/bgsys/drivers/ppcfloor/tools/coreprocessor</code>, <code>gdbserver</code> ...  </li>
<li>
Available file systems. See <a href="http://www.fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JUDGE/Userinfo/Access_Environment.html">JSC documentation</a> for more details.  </li>
<li>
<p class="startli">Querying <b>Quota Status</b>: </p><div class="fragment"><div class="line">q_cpuquota &lt;options&gt;</div>
</div><!-- fragment --><p class="endli">Useful options: </p><ul>
<li><code>-?</code> usage information and all options . </li>
<li><code>-j &lt;jobstepid&gt;</code> for a single job. </li>
<li><code>-t &lt;time&gt;</code> for all jobs in the specified time, e.g. <code>q_cpuquota -t 23.11.2011 01.12.2011</code>. </li>
<li><code>-d &lt;number&gt;</code> for last number of days (positive integer).  </li>
</ul>
</li>
</ul>
<hr  />
 <h2><a class="anchor" id="secVery_large_jobs_on_JuGene"></a>
Very large Jobs on JuGene</h2>
<ul>
<li>
<p class="startli">Although its possible on <em>JuGene</em> to create shared libraries and run dynamically linked executables this is <b>in general not recommended</b>, since loading of shared libraries can delay the startup of such an application considerably, especially when using large partitions (8 racks or more). See also <a href="http://www.fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JUGENE/UserInfo/SharedLibraries.html">Shared Libraries and Dynamic Executables</a>.</p>
<p class="endli">So, for <b>very large jobs</b> be sure to have <b>ug4</b> built as a <b>completely static executable</b> (c.f. <a class="el" href="page_u_g4_parallel_ju_gene.html#secConfiguration_of_ug4_for_JuGene">Configuration of ug4 for JuGene</a>) since otherwise loading of the shared libraries consumes too much wall time!  </p>
</li>
<li>
<p class="startli"><b>Very large jobs</b> (e.g. jobs larger than 32 racks) normally run on <b>Tuesday</b> only.</p>
<p class="endli">Exceptions to this rule are possible in urgent cases (please contact the SC Support under <a href="sc@fz-juelich.de">sc@fz-juelich.de</a>).  </p>
</li>
</ul>
<hr  />
 <h2><a class="anchor" id="secDebuggingOnJuGene"></a>
Debugging on JuGene</h2>
<p>On JuGene the parallel debuggers <em>TotalView</em> and <em>DDT</em> are available.</p>
<p>Be sure to compile <b>ug4</b> as a debug build.</p>
<p>DDT uses X11 for its graphical user interface. Be sure to log in with an X window forwarding enabled. This could mean using the <code>-X</code> or <code>-Y</code> option to <code>ssh</code>.</p>
<p><b>Basic usage of <em>DDT</b></em>: </p><ol>
<li>
Load the appropriate module: <div class="fragment"><div class="line">module load UNITE ddt</div>
</div><!-- fragment -->  </li>
<li>
Start DDT by typing <code>ddt</code>. </li>
<li>
A "DDT" logo appears, wait a bit (or click on the logo) to get the welcome dialog box. </li>
<li>
Click on "Run and Debug a Program" in the "Welcome" dialog box </li>
<li>
<p class="startli">Enter your <b>ug4</b> parameters (don't forget to enclose them by quotation marks), numbers of processes to run, a (hopefully) appropriate wall time to do all your debugging work (after "Queue submission Parameters"), "MPIRun parameters" (e.g. <code>-mode VN -mapfile TXYZ -verbose 2</code>) in the fields provided after clicking "Advanced\&gt;\&gt;" etc., then click the "Submit" button.</p>
<p class="endli">Wait until the job is launched (you might exercise some patience), DDT will catch the focus automatically when resources are available. </p>
</li>
</ol>
<p>The rest should be quite self-explaining.</p>
<p>One can also immediately specify the application to debug and also its parameters by typing <code>ddt [&lt;your app&gt; &lt;parameters&gt;]</code>.</p>
<p><b>Basic usage of <em>TotalView</b></em>: </p><ol>
<li>
Load the appropriate module: <div class="fragment"><div class="line">module load UNITE totalview</div>
</div><!-- fragment -->  </li>
<li>
Start TotalView by adding the <code>-tv</code> flag to your <code>llrun</code> call with which you normally would run your executable in interactive mode (see above). </li>
</ol>
<p><b>Example debug sessions</b>: </p><ol>
<li>
<p class="startli">Start a <em>DDT</em> debugging session (immediately specifying the executable to debug): </p><div class="fragment"><div class="line">ddt</div>
</div><!-- fragment --><p class="interli">Specification of executable and parameters should also work - parameters are written in the appropriate field, but not recognised .... </p><div class="fragment"><div class="line">ddt ./ugshell_debug -<a class="code" href="command__line__util_8lua.html#a340d3719e63a0a3a4f4429ef8c8b55ea">ex</a> ../apps/scaling_tests/modular_scalability_test.lua -<a class="codeRef" href="../plugins/example__free__surface_2evaluate_8lua.html#ad2464918eb8162cae4af3f470845f0d9">numRefs</a>  7</div>
<div class="ttc" id="acommand__line__util_8lua_html_a340d3719e63a0a3a4f4429ef8c8b55ea"><div class="ttname"><a href="command__line__util_8lua.html#a340d3719e63a0a3a4f4429ef8c8b55ea">ex</a></div><div class="ttdeci">parameterString ex</div><div class="ttdoc">Executes the specified script.</div><div class="ttdef"><b>Definition:</b> command_line_util.lua:350</div></div>
<div class="ttc" id="aexample__free__surface_2evaluate_8lua_html_ad2464918eb8162cae4af3f470845f0d9"><div class="ttname"><a href="../plugins/example__free__surface_2evaluate_8lua.html#ad2464918eb8162cae4af3f470845f0d9">numRefs</a></div><div class="ttdeci">parameterNumber numRefs</div></div>
</div><!-- fragment --><p class="endli">The mpirun parameters, e.g. <code>-mapfile TXYZ -verbose 2</code> can be placed in the fields accessible after clicking on the "Advanced" button.  </p>
</li>
<li>
<p class="startli">Start a <em>TotalView</em> debugging session: </p><div class="fragment"><div class="line">llrun -tv -np 4 -mode VN -mapfile TXYZ -<a class="code" href="checkpoint__util_8lua.html#a7e587ebfa42129125fe2e79410a09ef8">verbose</a> 2 -exe ./ugshell_debug -args <span class="stringliteral">&quot;-ex ../apps/scaling_tests/modular_scalability_test.lua -numPreRefs 3 -numRefs  7&quot;</span></div>
</div><!-- fragment --><p> Use the <code>llrun</code> option <code> -w &lt;hh:mm:ss&gt;</code> to specify a (hopefully) appropriate wall time to do all your debugging work.</p>
<p class="endli"></p>
</li>
</ol>
<p>For additional information (especially for debugging with TotalView) see <a href="http://www.fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JUGENE/UserInfo/ParallelDebugging.html">http://www.fz-juelich.de/ias/jsc/EN/Expertise/Supercomputers/JUGENE/UserInfo/ParallelDebugging.html</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">ug4 - Documentation</a></li><li class="navelem"><a class="el" href="page_u_g4_setup.html">Setup and Installation</a></li><li class="navelem"><a class="el" href="page_u_g4_install.html">Prerequisites and Recommended Tools</a></li><li class="navelem"><a class="el" href="page_u_g4_setup_parallel.html">Installation on Parallel Computers</a></li>
    <li class="footer">Generated on Mon Oct 2 2023 00:54:32 for ug4 by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
