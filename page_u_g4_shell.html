<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ug4: ugshell</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ug4
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('page_u_g4_shell.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ugshell </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#secCommandLineOption">Command-Line Options</a></li>
<li class="level1"><a href="#secInteractiveShell">Interactive Shell</a><ul><li class="level2"><a href="#secAutoCompletion">Auto Completion</a></li>
</ul>
</li>
<li class="level1"><a href="#secRuntimeInformation">Runtime Information</a></li>
<li class="level1"><a href="#secDebugging">Debug Shell</a></li>
</ul>
</div>
<div class="textblock"><p>For any questions, contact martin.rupp@gcsc.uni-frankfurt.de.</p>
<hr  />
 <h1><a class="anchor" id="secCommandLineOption"></a>
Command-Line Options</h1>
<p><em>ugshell</em> has the following build-in command-line options:</p><ul>
<li><code>-outproc id</code> &mdash; Sets the output-proc to id. Default is 0.</li>
<li><code>-ex scriptname</code> &mdash; Executes the specified script.</li>
<li><code>-noquit</code> &mdash; Does run the interactive shell after specified script.</li>
<li><code>-noterm</code> &mdash; Terminal logging will be disabled.</li>
<li><code>-logtofile filename</code> &mdash; Output will be written to the specified file.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>There is bash completion available for ugshell, see <a class="el" href="page_bash_tools.html">BASH Tools</a>. <br  />
</dd></dl>
<p>Script files are written in LUA, see <a class="el" href="page_script_tutorial.html">Scripting Tutorials</a> for an introduction.</p>
<p>You can also use the command line to pass arguments to your scripts: </p><pre class="fragment">./ugshell -ex tutorials/tut02_loading_a_domain.lua -grid unit_square/unit_square_quads_2x2.ugx  
</pre><p>You can access command line parameters by using the lua function from <a href="ug__util_8lua.html">util.lua</a>: </p><div class="fragment"><div class="line"><span class="keyword">function</span> util.GetParam(<a class="code" href="checkpoint__util_8lua.html#a3c1958e225ed64db3e56badcbdcc8df7">name</a>, return_if_unavailable)</div>
<div class="ttc" id="acheckpoint__util_8lua_html_a3c1958e225ed64db3e56badcbdcc8df7"><div class="ttname"><a href="checkpoint__util_8lua.html#a3c1958e225ed64db3e56badcbdcc8df7">name</a></div><div class="ttdeci">location name</div><div class="ttdef"><b>Definition:</b> checkpoint_util.lua:128</div></div>
</div><!-- fragment --><p> For that, you have to include the <code><a class="el" href="ug__util_8lua.html">ug_util.lua</a></code> file using <code>ug_load_script("ug_util.lua")</code>.</p>
<p>ug_load_script will search for files in the following directories (in that order)</p><ul>
<li>relative to current script</li>
<li>as absolute filename</li>
<li>in the scripts path</li>
<li>in the apps path</li>
<li>in the ug4 path. <dl class="section note"><dt>Note</dt><dd>ug_load_script will load files parallel, so you have to be sure that all processes are calling ug_load_script. if you want to load a different file or files only on some cores, you can use ug_load_script_single.</dd></dl>
Example: <div class="fragment"><div class="line">ug_load_script(<span class="stringliteral">&quot;ug_util.lua&quot;</span>)</div>
<div class="line">gridName = util.<a class="code" href="command__line__util_8lua.html#a63b1d74a181e06827e92032e362b1740">GetParam</a>(&quot;-grid&quot;, &quot;unit_square/unit_square_quads_8x8.ugx&quot;)</div>
<div class="ttc" id="acommand__line__util_8lua_html_a63b1d74a181e06827e92032e362b1740"><div class="ttname"><a href="command__line__util_8lua.html#a63b1d74a181e06827e92032e362b1740">GetParam</a></div><div class="ttdeci">function util GetParam(name, default, description, options, atype)</div></div>
</div><!-- fragment --> You can find out more about provided scripts in <a class="el" href="page_lua_script.html">Provided LUA Scripts</a>.</li>
</ul>
<p>If there is no commandline argument <code>"-grid"</code>, then the second argument is returned by <code>util.GetParam</code>. Otherwise, the argument after <code>"-grid"</code> in the commandline is returned. Notice that omitted parameters to Lua-functions are treated as <code>nil</code>, so <code>util.GetParam("-grid")</code> is the same as <code>util.GetParam("-grid", nil)</code>. If you want your argument to be casted to a number, use <code>util.GetParamNumber</code>: </p><div class="fragment"><div class="line"><span class="keyword">function</span> util.GetParamNumber(<a class="code" href="checkpoint__util_8lua.html#a3c1958e225ed64db3e56badcbdcc8df7">name</a>, return_if_unavailable)</div>
</div><!-- fragment --><p> If the argument is not a number, the second argument is returned. To check if an option is in the command line, use <code>util.HasParamOption</code>: </p><div class="fragment"><div class="line"><span class="keyword">function</span> util.HasParamOption(<a class="code" href="checkpoint__util_8lua.html#a3c1958e225ed64db3e56badcbdcc8df7">name</a>)</div>
</div><!-- fragment --><p>Examples: </p><div class="fragment"><div class="line"><a class="codeRef" href="../plugins/group__small__strain__mechanics.html#ga425548c7b0fe054612f37d1f3a4826b6">dim</a> = util.GetParamNumber(<span class="stringliteral">&quot;-dim&quot;</span>, 2)</div>
<div class="line">useAggressiveCoarsening = util.HasParamOption(<span class="stringliteral">&quot;-AC&quot;</span>)</div>
<div class="ttc" id="agroup__small__strain__mechanics_html_ga425548c7b0fe054612f37d1f3a4826b6"><div class="ttname"><a href="../plugins/group__small__strain__mechanics.html#ga425548c7b0fe054612f37d1f3a4826b6">dim</a></div><div class="ttdeci">static const int dim</div></div>
</div><!-- fragment --><p>You can abort the execution of <b>ug4</b> out of Lua scripts by using <code>exit()</code>. If you want to stop the execution of a script at a specific place, but you want to use the interactive shell thereafter, insert at that place a call like <code>error("break")</code> (or whatever message sounds reasonable to you) and start the run with the <code>-noquit</code>. option</p>
<hr  />
 <h1><a class="anchor" id="secInteractiveShell"></a>
Interactive Shell</h1>
<p>When starting <em>ugshell</em> without arguments, you get the following output: </p><pre class="fragment">ug:&gt; 
</pre><p> and a blinking cursor: This is called the <em>interactive shell</em>. Interactive shell is disabled when you use <code>-ex</code> without <code>-noquit</code> and if <b>ug4</b> is running in parallel.</p>
<p>In the interactive shell you can do everything just like in a .lua file, for example: <code>&lt;scriptname&gt;</code> (as usual) by executing <code>ug_load_script()</code>: </p><pre class="fragment">ug:&gt; ug_load_script(&lt;scriptname&gt;)
</pre><h2><a class="anchor" id="secAutoCompletion"></a>
Auto Completion</h2>
<p>The interactive <em>ugshell</em> has some auto-completion features implemented. When you enter a part of something and hit <em>tab</em> <em>ugshell</em> tries to auto-complete your input. If there is not a unique completion, and you hit <em>tab</em> again, you get a list of possible completions.</p>
<ul>
<li>
Path Completion:<br  />
 <code>"../scr"</code> -&gt; <code>"../scripts/"</code><br  />
 (only tried if the word left from the cursor starts with a ")  </li>
<li>
Member Function Completion:<br  />
 <code>mainProfileNode:cal</code> -&gt; <code>mainProfileNode:call_tree</code><br  />
 (only tried if there is a : in the word)  </li>
<li>
Table/"Namespace" Completion:<br  />
 <code>math.e</code> -&gt; <code>math.exp</code>  </li>
<li>
Completion of Lua globals, internal functions and modules (like <em>math</em>, <em>io</em>, <em>string</em>), classes and global functions from the <em>ug4-registry</em>, and functions defined in Lua script.  </li>
</ul>
<hr  />
 <h1><a class="anchor" id="secRuntimeInformation"></a>
Runtime Information</h1>
<p>You can get Information about the current state of Lua by the following methods: </p><ul>
<li>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> TypeInfo(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">typename</span>)</div>
</div><!-- fragment --> <code>TypeInfo</code> prints all information available for the data you insert. Note that you have to enclose your type name with <code>"&lt;/tt&gt;.
    Example: &lt;tt&gt;TypeInfo("Grid")</code>. <code>TypeInfo</code> works with <ul>
<li>
tables, and prints their content recursively </li>
<li>
all other basic lua types: numbers, strings, ... </li>
<li>
lua script functions, and prints their code </li>
<li>
classes, global functions and member function from the ug4-registry </li>
</ul>
</li>
<li>
In interactive shell, the use of <code>TypeInfo</code> can be abbreviated by using <pre class="fragment">ug:&gt; Grid?</pre> and hitting enter. When the name left to the cursor is unambiguous, hitting tab three times also displays information about the object. Functions show their parameters when you enter the function and the first bracket <pre class="fragment">ug:&gt; GetProfileNode(</pre> and hit tab.  </li>
<li>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="namespaceug_1_1bridge.html#a00d5399040806179d0da2c0d78a20072">ClassUsage</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">typename</span>)</div>
<div class="ttc" id="anamespaceug_1_1bridge_html_a00d5399040806179d0da2c0d78a20072"><div class="ttname"><a href="namespaceug_1_1bridge.html#a00d5399040806179d0da2c0d78a20072">ug::bridge::ClassUsage</a></div><div class="ttdeci">string ClassUsage(const char *classname)</div><div class="ttdef"><b>Definition:</b> info_commands.cpp:645</div></div>
</div><!-- fragment --><p> <code>ClassUsage</code> prints the usage of the class, that is: </p><ul>
<li>
Functions returning an instantiation of the class </li>
<li>
Functions which require one argument to be of the type of the class or of a base class  </li>
<li>
Instatiations in Lua which have the type class or a subclass of the class.  </li>
</ul>
<p class="endli">Example (excerpt): </p><pre class="fragment">ug:&gt; ClassUsage("Domain2d")

--- Functions returning Domain2d: ---
 Domain2d* IApproximationSpace2d:domain()
--- Functions using Domain2d: ---
 bool Domain2d:LoadDomain (Domain2d* Domain, string Filename, integer Number Refinements)
 bool Domain2d:DistributeDomain (Domain2d* )
 IRefiner* Domain2d:GlobalDomainRefiner (Domain2d* )
 Domain2d:TestDomainInterfaces (Domain2d* )
 IApproximationSpace2d:assign_domain ([Domain2d* ])
 DirichletBND2d:set_domain ([Domain2d* ])

Instantiations of Class Domain2d:
dom        (Domain2d)</pre>  </li>
<li>
<p class="startli">Listing </p><ul>
<li>
<code>list_luaObjects()</code> : Lists all Objects created by lua or in lua scripts. </li>
<li>
<code>list_cfunctions()</code> : Lists all <a href="http://cave1.gcsc.uni-frankfurt.de/job/ug-bridge-doc/javadoc/functions.html">global functions</a> provided by the current registry. </li>
<li>
<code>list_classes()</code> : Lists all <a href="http://cave1.gcsc.uni-frankfurt.de/job/ug-bridge-doc/javadoc/index.html">Classes</a> provided by the current registry. </li>
<li>
<code>list_scriptFunctions()</code> : Lists all LUA functions provided by you or loaded scripts. </li>
<li>
<code>list_internalFunctions()</code> : Lists all functions (these are also internal registry or lua functions). </li>
<li>
<code>ls()</code> lists all of the above. </li>
</ul>
<hr  />
 </li>
</ul>
<h1><a class="anchor" id="secDebugging"></a>
Debug Shell</h1>
<p>You can also debug your Lua Script using the shell. For this, you can use the script functions </p><ul>
<li>
<pre class="fragment">breakpoint()</pre> <code><a class="el" href="namespaceug_1_1script.html#a7be9d7845e88f8196d0150d726141395">breakpoint()</a></code> breaks the execution of the script at exactly the location it stands. This is the preferred method of setting a breakpoint.  </li>
<li>
<pre class="fragment">breakpoint(source, line)</pre> <code>breakpoint("laplace.lua", 69)</code> adds a breakpoint at the file <code>"laplace.lua"</code> (path relative to current script). <code>print_breakpoints</code> prints those. Note that only lines with code are "catched" by the compiler.  </li>
</ul>
<p>When your breakpoint is reached, you are entering the <b>ug4</b> <em>debug shell</em>: </p><pre class="fragment">./../scripts/laplace.lua:69 breakpoint()
debug:&gt; 
</pre><p>The debug shell is like the normal ugshell (so it has <a class="el" href="page_u_g4_shell.html#secAutoCompletion">Auto Completion</a> and <a class="el" href="page_u_g4_shell.html#secRuntimeInformation">Runtime Information</a>), but you have some extra commands. Most of them have a similar function as in <em>gdb:</em> </p><ul>
<li><code>continue, cont</code> &mdash; Continues execution.</li>
<li><code>step</code> &mdash; Continues execution until the next line is reached, steps into subroutines.</li>
<li><code>next</code> &mdash; Continues execution until the next line is reached, does not step into subroutines (that is, we are skipping lines with greater function stack depth).</li>
<li><code>finish</code> &mdash; Finishes subroutines/scripts (continues execution until a line is reached with lower function stack depth).</li>
<li><code>list</code> &mdash; Lists the script surrounding the current statement.</li>
<li><code>backtrace, bt</code> &mdash; Prints the function stack.</li>
<li><code>up, down</code> &mdash; Goes up and down the function stack.</li>
<li><code>quit, exit</code> &mdash; Like in normal shell, exits ug4 directly.</li>
<li><code>print VAL</code> &mdash; Like <code>VAL?</code></li>
</ul>
<p>Note that you don't have to configure <b>ug4</b> with <code>cmake -DDEBUG=ON ..</code>) to use the debug shell. There is a small performance drawback when using <code>breakpoint(source, line)</code> because we have to check for every line if it is a break line. This is especially the case if you have lots of small calls in your Lua script. However, there is no performance drawback in <code><a class="el" href="namespaceug_1_1script.html#a7be9d7845e88f8196d0150d726141395">breakpoint()</a></code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">ug4 - Documentation</a></li><li class="navelem"><a class="el" href="page_u_g4_usage.html">Usage</a></li>
    <li class="footer">Generated on Mon Sep 4 2023 00:53:24 for ug4 by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
